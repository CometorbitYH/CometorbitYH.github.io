<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>数据库 | MY</title><meta name="description" content="数据库"><meta name="keywords" content="MYSQL,数据库"><meta name="author" content="杨涵"><meta name="copyright" content="杨涵"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://cometorbityh.github.io/2019/11/25/数据库/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="数据库"><meta name="twitter:description" content="数据库"><meta name="twitter:image" content="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126231814.jpg"><meta property="og:type" content="article"><meta property="og:title" content="数据库"><meta property="og:url" content="https://cometorbityh.github.io/2019/11/25/数据库/"><meta property="og:site_name" content="MY"><meta property="og:description" content="数据库"><meta property="og:image" content="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126231814.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="JAVA 多线程：1" href="https://cometorbityh.github.io/2019/11/26/JAVA-多线程：1/"><link rel="next" title="JAVA 集合：Collections" href="https://cometorbityh.github.io/2019/11/24/JAVA-集合：Collections/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: {"languages":{"author":"作者: 杨涵","link":"链接: https://cometorbityh.github.io/2019/11/25/数据库/","source":"来源: MY","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  copy_copyright_js: true
  
}</script></head><body><canvas class="fireworks"></canvas><div id="header"> <div id="page-header"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">MY</a></span><i class="fa fa-bars fa-fw toggle-menu pull-right close" aria-hidden="true"></i><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lozad avatar_img" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">16</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">9</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#数据库介绍"><span class="toc_mobile_items-text">数据库介绍</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#什么是数据库？"><span class="toc_mobile_items-text">什么是数据库？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据库的特点"><span class="toc_mobile_items-text">数据库的特点</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#SQL"><span class="toc_mobile_items-text">SQL</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#什么是SQL？"><span class="toc_mobile_items-text">什么是SQL？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#SQL通用语法"><span class="toc_mobile_items-text">SQL通用语法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#SQL分类"><span class="toc_mobile_items-text">SQL分类</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#DQL"><span class="toc_mobile_items-text">DQL</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#DML"><span class="toc_mobile_items-text">DML</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#约束"><span class="toc_mobile_items-text">约束</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-非空约束（not-null）"><span class="toc_mobile_items-text">(1) 非空约束（not null）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-唯一约束（unique）"><span class="toc_mobile_items-text">(2) 唯一约束（unique）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-主键约束（primary-key）"><span class="toc_mobile_items-text">(3) 主键约束（primary key）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-外键约束（foreign-key）"><span class="toc_mobile_items-text">(4) 外键约束（foreign key）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-级联操作"><span class="toc_mobile_items-text">(5) 级联操作</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#级联更新"><span class="toc_mobile_items-text">级联更新</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#级联删除（谨慎使用！）"><span class="toc_mobile_items-text">级联删除（谨慎使用！）</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#数据库的设计"><span class="toc_mobile_items-text">数据库的设计</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#多表之间的关系"><span class="toc_mobile_items-text">多表之间的关系</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-一对一"><span class="toc_mobile_items-text">(1) 一对一 *</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-一对多-多对一"><span class="toc_mobile_items-text">(2) 一对多 / 多对一</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-多对多"><span class="toc_mobile_items-text">(3) 多对多</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#案例"><span class="toc_mobile_items-text">案例</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据库的设计准则——范式"><span class="toc_mobile_items-text">数据库的设计准则——范式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-第一范式（1NF）"><span class="toc_mobile_items-text">(1) 第一范式（1NF）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-第二范式（2NF）"><span class="toc_mobile_items-text">(2) 第二范式（2NF）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-第三范式（3NF）"><span class="toc_mobile_items-text">(3) 第三范式（3NF）</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#DQL-1"><span class="toc_mobile_items-text">DQL</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#单表查询"><span class="toc_mobile_items-text">单表查询</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#–-1-基础查询"><span class="toc_mobile_items-text">– (1) 基础查询</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#–-2-条件查询"><span class="toc_mobile_items-text">– (2) 条件查询</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#–-3-排序查询"><span class="toc_mobile_items-text">– (3) 排序查询</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#–-4-计算列（聚合函数）"><span class="toc_mobile_items-text">– (4) 计算列（聚合函数）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#–-5-分组查询"><span class="toc_mobile_items-text">– (5) 分组查询</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#–-6-分页查询"><span class="toc_mobile_items-text">– (6) 分页查询</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#多表查询"><span class="toc_mobile_items-text">多表查询</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#笛卡尔积"><span class="toc_mobile_items-text">笛卡尔积</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-内连接查询"><span class="toc_mobile_items-text">(1) 内连接查询</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-外连接查询"><span class="toc_mobile_items-text">(2) 外连接查询</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-子查询（嵌套查询）"><span class="toc_mobile_items-text">(3) 子查询（嵌套查询）</span></a></li></ol></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#数据库的备份和还原"><span class="toc_mobile_items-text">数据库的备份和还原</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#事务"><span class="toc_mobile_items-text">事务</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#概念-步骤"><span class="toc_mobile_items-text">概念 + 步骤</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#事务提交的两种方式"><span class="toc_mobile_items-text">事务提交的两种方式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#事务的四大特征（⭐）"><span class="toc_mobile_items-text">事务的四大特征（⭐）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#事务的隔离级别（⭐）"><span class="toc_mobile_items-text">事务的隔离级别（⭐）</span></a></li></ol></li></ol></div></div><div id="body-wrap"><div id="web_bg"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库介绍"><span class="toc-text">数据库介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#什么是数据库？"><span class="toc-text">什么是数据库？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据库的特点"><span class="toc-text">数据库的特点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL"><span class="toc-text">SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#什么是SQL？"><span class="toc-text">什么是SQL？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL通用语法"><span class="toc-text">SQL通用语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL分类"><span class="toc-text">SQL分类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DQL"><span class="toc-text">DQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DML"><span class="toc-text">DML</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#约束"><span class="toc-text">约束</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-非空约束（not-null）"><span class="toc-text">(1) 非空约束（not null）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-唯一约束（unique）"><span class="toc-text">(2) 唯一约束（unique）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-主键约束（primary-key）"><span class="toc-text">(3) 主键约束（primary key）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-外键约束（foreign-key）"><span class="toc-text">(4) 外键约束（foreign key）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-级联操作"><span class="toc-text">(5) 级联操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#级联更新"><span class="toc-text">级联更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#级联删除（谨慎使用！）"><span class="toc-text">级联删除（谨慎使用！）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库的设计"><span class="toc-text">数据库的设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#多表之间的关系"><span class="toc-text">多表之间的关系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-一对一"><span class="toc-text">(1) 一对一 *</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-一对多-多对一"><span class="toc-text">(2) 一对多 / 多对一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-多对多"><span class="toc-text">(3) 多对多</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#案例"><span class="toc-text">案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据库的设计准则——范式"><span class="toc-text">数据库的设计准则——范式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-第一范式（1NF）"><span class="toc-text">(1) 第一范式（1NF）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-第二范式（2NF）"><span class="toc-text">(2) 第二范式（2NF）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-第三范式（3NF）"><span class="toc-text">(3) 第三范式（3NF）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DQL-1"><span class="toc-text">DQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#单表查询"><span class="toc-text">单表查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#–-1-基础查询"><span class="toc-text">– (1) 基础查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#–-2-条件查询"><span class="toc-text">– (2) 条件查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#–-3-排序查询"><span class="toc-text">– (3) 排序查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#–-4-计算列（聚合函数）"><span class="toc-text">– (4) 计算列（聚合函数）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#–-5-分组查询"><span class="toc-text">– (5) 分组查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#–-6-分页查询"><span class="toc-text">– (6) 分页查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多表查询"><span class="toc-text">多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#笛卡尔积"><span class="toc-text">笛卡尔积</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-内连接查询"><span class="toc-text">(1) 内连接查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-外连接查询"><span class="toc-text">(2) 外连接查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-子查询（嵌套查询）"><span class="toc-text">(3) 子查询（嵌套查询）</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据库的备份和还原"><span class="toc-text">数据库的备份和还原</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#事务"><span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#概念-步骤"><span class="toc-text">概念 + 步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#事务提交的两种方式"><span class="toc-text">事务提交的两种方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#事务的四大特征（⭐）"><span class="toc-text">事务的四大特征（⭐）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#事务的隔离级别（⭐）"><span class="toc-text">事务的隔离级别（⭐）</span></a></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126231814.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">数据库</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-11-25<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-11-26</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/数据库/">数据库</a></span><div class="post-meta-wordcount"><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="数据库介绍"><a href="#数据库介绍" class="headerlink" title="数据库介绍"></a>数据库介绍</h1><blockquote>
<p>数据库 —– DataBase —– DB</p>
</blockquote>
<h2 id="什么是数据库？"><a href="#什么是数据库？" class="headerlink" title="什么是数据库？"></a>什么是数据库？</h2><blockquote>
<p> 用于存储和管理数据的仓库。</p>
</blockquote>
<h2 id="数据库的特点"><a href="#数据库的特点" class="headerlink" title="数据库的特点"></a>数据库的特点</h2><blockquote>
<ol>
<li>持久化存储数据的。其实数据库就是一个文件系统</li>
<li>方便存储和管理数据</li>
<li>使用了统一的方式操作数据库 —&gt; SQL</li>
</ol>
</blockquote>
<h1 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h1><h2 id="什么是SQL？"><a href="#什么是SQL？" class="headerlink" title="什么是SQL？"></a>什么是SQL？</h2><blockquote>
<p>Structured Query Language：结构化查询语言</p>
<p>其实就是定义了操作所有关系型数据库的<strong>规则</strong>。每一种数据库操作的方式存在不一样的地方，称为“方言”。</p>
</blockquote>
<h2 id="SQL通用语法"><a href="#SQL通用语法" class="headerlink" title="SQL通用语法"></a>SQL通用语法</h2><pre><code>1. SQL 语句可以单行或多行书写，以分号结尾。
2. 可使用空格和缩进来增强语句的可读性。
3. MySQL 数据库的 SQL 语句不区分大小写，关键字建议使用大写。
4. 3 种注释
    * 单行注释: -- 注释内容 或 # 注释内容(mysql 特有) 
    * 多行注释: /* 注释 */</code></pre><h2 id="SQL分类"><a href="#SQL分类" class="headerlink" title="SQL分类"></a>SQL分类</h2><blockquote>
<p><strong>DDL ( Data Definition Language ) 数据定义语言</strong><br>    用来定义数据库对象：数据库，表，列等。关键字：create, drop,alter 等</p>
<p><strong>DML ( Data Manipulation Language ) 数据操作语言</strong><br>    用来对数据库中表的数据进行增删改。关键字：insert, delete, update 等</p>
<p><strong>DQL ( Data Query Language ) 数据查询语言</strong><br>    用来查询数据库中表的记录(数据)。关键字：select, where 等</p>
<p>DCL ( Data Control Language ) 数据控制语言(了解)<br>    用来定义数据库的访问权限和安全级别，及创建用户。关键字：GRANT， REVOKE 等</p>
</blockquote>
<h1 id="DQL"><a href="#DQL" class="headerlink" title="DQL"></a>DQL</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">=========建表==========</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student (</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>, <span class="comment">-- 编号</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>), <span class="comment">-- 姓名</span></span><br><span class="line">age <span class="built_in">int</span>, <span class="comment">-- 年龄</span></span><br><span class="line">sex <span class="built_in">varchar</span>(<span class="number">5</span>), <span class="comment">-- 性别</span></span><br><span class="line">address <span class="built_in">varchar</span>(<span class="number">100</span>), <span class="comment">-- 地址</span></span><br><span class="line">math <span class="built_in">int</span>, <span class="comment">-- 数学</span></span><br><span class="line">english <span class="built_in">int</span> <span class="comment">-- 英语</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(<span class="keyword">id</span>,<span class="keyword">NAME</span>,age,sex,address,math,english) <span class="keyword">VALUES</span> </span><br><span class="line">    (<span class="number">1</span>,<span class="string">'马云'</span>,<span class="number">55</span>,<span class="string">'男'</span>,<span class="string">'杭州'</span>,<span class="number">66</span>,<span class="number">78</span>),</span><br><span class="line">    (<span class="number">2</span>,<span class="string">'马化腾'</span>,<span class="number">45</span>,<span class="string">'女'</span>,<span class="string">'深圳'</span>,<span class="number">98</span>,<span class="number">87</span>),</span><br><span class="line">    (<span class="number">3</span>,<span class="string">'马景涛'</span>,<span class="number">55</span>,<span class="string">'男'</span>,<span class="string">'香港'</span>,<span class="number">56</span>,<span class="number">77</span>),</span><br><span class="line">    (<span class="number">4</span>,<span class="string">'柳岩'</span>,<span class="number">20</span>,<span class="string">'女'</span>,<span class="string">'湖南'</span>,<span class="number">76</span>,<span class="number">65</span>),</span><br><span class="line">    (<span class="number">5</span>,<span class="string">'柳青'</span>,<span class="number">20</span>,<span class="string">'男'</span>,<span class="string">'湖南'</span>,<span class="number">86</span>,<span class="literal">NULL</span>),</span><br><span class="line">    (<span class="number">6</span>,<span class="string">'刘德华'</span>,<span class="number">57</span>,<span class="string">'男'</span>,<span class="string">'香港'</span>,<span class="number">99</span>,<span class="number">99</span>),</span><br><span class="line">    (<span class="number">7</span>,<span class="string">'马德'</span>,<span class="number">22</span>,<span class="string">'女'</span>,<span class="string">'香港'</span>,<span class="number">99</span>,<span class="number">99</span>),</span><br><span class="line">    (<span class="number">8</span>,<span class="string">'德玛西亚'</span>,<span class="number">18</span>,<span class="string">'男'</span>,<span class="string">'南京'</span>,<span class="number">56</span>,<span class="number">65</span>);</span><br></pre></td></tr></table></figure>

<h1 id="DML"><a href="#DML" class="headerlink" title="DML"></a>DML</h1><h1 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h1><p>约束 —–&gt; 对表中数据进行限定，从而保证数据的正确性、有效性和完整性</p>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191125234254.png" class="lozad">



<h2 id="1-非空约束（not-null）"><a href="#1-非空约束（not-null）" class="headerlink" title="(1) 非空约束（not null）"></a>(1) 非空约束（not null）</h2><p>定义某列的数据不能为空</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表时添加非空约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table1(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span>,</span><br><span class="line">	<span class="keyword">name</span> VAECHAR(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>	</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建表后删除非空约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table1 <span class="keyword">MODIFY</span> <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建表后添加非空约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table1 <span class="keyword">MODIFY</span> <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>

<h2 id="2-唯一约束（unique）"><a href="#2-唯一约束（unique）" class="headerlink" title="(2) 唯一约束（unique）"></a>(2) 唯一约束（unique）</h2><p>注意：MYSQL中唯一约束限定的列的值可以有多个NULL</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表时添加唯一约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table1(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span>,</span><br><span class="line">	phone VAECHAR(<span class="number">20</span>) <span class="keyword">UNIQUE</span>	</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建表后删除唯一约束（也称唯一索引）</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table1 <span class="keyword">DROP</span> <span class="keyword">INDEX</span> phone;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建表后添加唯一约束</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table1 <span class="keyword">MODIFY</span> phone <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">UNIQUE</span>;</span><br></pre></td></tr></table></figure>

<h2 id="3-主键约束（primary-key）"><a href="#3-主键约束（primary-key）" class="headerlink" title="(3) 主键约束（primary key）"></a>(3) 主键约束（primary key）</h2><p><code>主键 = 非空 + 唯一</code></p>
<ul>
<li><p>一张表中只能由一个字段是主键</p>
</li>
<li><p>主键就是表中记录的唯一标识</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表时添加主键约束</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> STU(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">	<span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除主键(因为一张表只有一个主键 因此不必声明具体字段名)</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stu <span class="keyword">DROP</span> PRIMARY <span class="keyword">KEY</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建表后添加主键</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stu <span class="keyword">MODIFY</span> <span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><strong>自动增长</strong></p>
<ul>
<li><p>某一列时数值类型的，可以使用 <code>auto_increment</code> 来完成自动增长，这样添加数据时可无需指定该字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表时添加主键约束(自动增长)</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stu(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">	<span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> stu <span class="keyword">VALUES</span>(<span class="literal">NULL</span>,qqq);	<span class="comment">-- 不指定自动增长的字段</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> stu <span class="keyword">VALUES</span>(<span class="number">10</span>,sss);		<span class="comment">-- 可以自己指定自增的字段</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> stu <span class="keyword">VALUES</span>(<span class="literal">NULL</span>,sss);	<span class="comment">-- 注意该条数据中自增的字段为11 与上一条插入的数据有关</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除自增</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stu <span class="keyword">MODIFY</span> <span class="keyword">id</span> <span class="built_in">INT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建表后添加自增</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stu <span class="keyword">MODIFY</span> <span class="keyword">id</span> <span class="built_in">INT</span> AUTO_INCREMENT;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="4-外键约束（foreign-key）"><a href="#4-外键约束（foreign-key）" class="headerlink" title="(4) 外键约束（foreign key）"></a>(4) 外键约束（foreign key）</h2><p>首先创建一张表，观察表中数据会发现：这个表的数据有些冗余，而且增加和删除数据都很麻烦</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp (</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line"><span class="keyword">NAME</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>),</span><br><span class="line">age <span class="built_in">INT</span>,</span><br><span class="line">dep_name <span class="built_in">VARCHAR</span>(<span class="number">30</span>),</span><br><span class="line">dep_location <span class="built_in">VARCHAR</span>(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp (<span class="keyword">NAME</span>, age, dep_name, dep_location) <span class="keyword">VALUES</span> (<span class="string">'张三'</span>, <span class="number">20</span>, <span class="string">'研发部'</span>, <span class="string">'广州'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp (<span class="keyword">NAME</span>, age, dep_name, dep_location) <span class="keyword">VALUES</span> (<span class="string">'李四'</span>, <span class="number">21</span>, <span class="string">'研发部'</span>, <span class="string">'广州'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp (<span class="keyword">NAME</span>, age, dep_name, dep_location) <span class="keyword">VALUES</span> (<span class="string">'王五'</span>, <span class="number">20</span>, <span class="string">'研发部'</span>, <span class="string">'广州'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp (<span class="keyword">NAME</span>, age, dep_name, dep_location) <span class="keyword">VALUES</span> (<span class="string">'老王'</span>, <span class="number">20</span>, <span class="string">'销售部'</span>, <span class="string">'深圳'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp (<span class="keyword">NAME</span>, age, dep_name, dep_location) <span class="keyword">VALUES</span> (<span class="string">'大王'</span>, <span class="number">22</span>, <span class="string">'销售部'</span>, <span class="string">'深圳'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp (<span class="keyword">NAME</span>, age, dep_name, dep_location) <span class="keyword">VALUES</span> (<span class="string">'小王'</span>, <span class="number">18</span>, <span class="string">'销售部'</span>, <span class="string">'深圳'</span>);</span><br></pre></td></tr></table></figure>

<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126131608.png" class="lozad">

<p>那我们如何解决呢？这里可以把这张数据表拆分成2张表，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建部门表（主表）</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> department(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">dep_name <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">dep_location <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建员工表（从表）</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> employee(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">age <span class="built_in">int</span>,</span><br><span class="line">dep_id <span class="built_in">int</span> <span class="comment">-- 外键对应主表的主键</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> department <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'研发部'</span>,<span class="string">'广州'</span>),(<span class="literal">null</span>, <span class="string">'销售部'</span>, <span class="string">'深圳'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'张三'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'李四'</span>, <span class="number">21</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'王五'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'老王'</span>, <span class="number">20</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'大王'</span>, <span class="number">22</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'小王'</span>, <span class="number">18</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 现在这2张表是好看了，但是他们之间还是没有关系啊！</p>
<p>没事，我们可以使用一个<strong>外键约束</strong>来关联这2张表</p>
</blockquote>
<p>创建表时添加外键约束</p>
<p><code>CONSTRAINT 外键名称 FOREIGN KEY (外键字段名称) REFERENCES 主表名称(主表列名称)</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建部门表（主表）</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> department(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">dep_name <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">dep_location <span class="built_in">varchar</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建员工表（从表）</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> employee(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">age <span class="built_in">int</span>,</span><br><span class="line">dep_id <span class="built_in">int</span>, <span class="comment">-- 外键对应主表的主键</span></span><br><span class="line"><span class="keyword">CONSTRAINT</span> emp_dept_fk <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (dep_id) <span class="keyword">REFERENCES</span> department(<span class="keyword">id</span>) <span class="comment">-- 外键约束</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> department <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'研发部'</span>,<span class="string">'广州'</span>),(<span class="literal">null</span>, <span class="string">'销售部'</span>, <span class="string">'深圳'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'张三'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'李四'</span>, <span class="number">21</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'王五'</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'老王'</span>, <span class="number">20</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'大王'</span>, <span class="number">22</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee (<span class="keyword">NAME</span>, age, dep_id) <span class="keyword">VALUES</span> (<span class="string">'小王'</span>, <span class="number">18</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p>删除外键约束</p>
<p><code>ALTER TABLE 表名 DROP FOREIGN KEY 外键名称;</code></p>
<p>创建表后添加外键约束</p>
<p><code>ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段名称) REFERENCES 主表名称(主表列名称)</code></p>
<h2 id="5-级联操作"><a href="#5-级联操作" class="headerlink" title="(5) 级联操作"></a>(5) 级联操作</h2><h3 id="级联更新"><a href="#级联更新" class="headerlink" title="级联更新"></a>级联更新</h3><p>当我们想修改主表的数值怎么办？由于从表的外键绑定着主表的数值，我们必须先修改从表中的数据，才能再修改主表中的数据</p>
<p>但是一个一个修改太麻烦了，有什么方法能够快速删除这些数据呢？</p>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126134059.png" class="lozad">

<p><strong>方法1（逐表修改）</strong></p>
<p>将从表中 dep_id = 1 更换成 dep_id = NULL</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> employee <span class="keyword">SET</span> dep_id = <span class="literal">NULL</span> <span class="keyword">WHERE</span> dep_id = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<img style="zoom: 67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126134355.png" class="lozad">

<p>修改主表数据，再更换从表数据</p>
<p><code>UPDATE employee SET dep_id = 4 WHERE dep_id IS NULL;</code></p>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126134745.png" class="lozad">



<p><strong>方法2（级联操作）</strong></p>
<p>重新修改外键，并在其后添加<code>ON UPDATE CASCADE</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> emp_dept_fk; <span class="comment">-- 删除外键</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> emp_dept_fk <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (dep_id) <span class="keyword">REFERENCES</span> department(<span class="keyword">id</span>) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span>; <span class="comment">-- 重新添加外键</span></span><br></pre></td></tr></table></figure>

<p>修改主表的数据时，从表的外键数据也会随之修改</p>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126135536.png" class="lozad">





<h3 id="级联删除（谨慎使用！）"><a href="#级联删除（谨慎使用！）" class="headerlink" title="级联删除（谨慎使用！）"></a>级联删除（谨慎使用！）</h3><p>那么我们是否可以：删除主表的数据时，从表的相关外键数据也随之删除呢？</p>
<p>重新修改外键，并在其后添加<code>ON DELETE CASCADE</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> emp_dept_fk; <span class="comment">-- 删除外键</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> emp_dept_fk <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (dep_id) <span class="keyword">REFERENCES</span> department(<span class="keyword">id</span>) <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span> <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">CASCADE</span>; <span class="comment">-- 重新添加外键</span></span><br></pre></td></tr></table></figure>

<p>删除主表的数据时，从表的外键数据也会随之删除（注意：是整条删除！）</p>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126135943.png" class="lozad">







<h1 id="数据库的设计"><a href="#数据库的设计" class="headerlink" title="数据库的设计"></a>数据库的设计</h1><h2 id="多表之间的关系"><a href="#多表之间的关系" class="headerlink" title="多表之间的关系"></a>多表之间的关系</h2><h3 id="1-一对一"><a href="#1-一对一" class="headerlink" title="(1) 一对一 *"></a>(1) 一对一 *</h3><blockquote>
<p>如：人 &lt;—–&gt; 身份证  ||  一个人对应一个身份证，一个身份证对应一个人</p>
</blockquote>
<blockquote>
<p>实现方式：<code>在任意一张表中添加唯一外键，指向另一个表的主键</code>，但一般情况下可以合成这2张表为一张表</p>
</blockquote>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126141000.png" class="lozad">

<h3 id="2-一对多-多对一"><a href="#2-一对多-多对一" class="headerlink" title="(2) 一对多 / 多对一"></a>(2) 一对多 / 多对一</h3><blockquote>
<p>如；部门 &lt;—–&gt; 员工  ||  一个部门有多个员工，一个员工对应一个部门</p>
</blockquote>
<blockquote>
<p>实现方式：<code>在多的一方建立外键，指向多的一方的主键</code></p>
</blockquote>
<img style="zoom: 67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126140738.png" class="lozad">

<h3 id="3-多对多"><a href="#3-多对多" class="headerlink" title="(3) 多对多"></a>(3) 多对多</h3><blockquote>
<p>如：学生 &lt;—–&gt; 课程  ||  一个学生可选多门课程，一个课程可被多个学生选择</p>
</blockquote>
<blockquote>
<p>实现方式：<code>新建中间表</code>，中间表至少包含2个字段，这2个字段作为中间表的外键，分别指向两张表的主键</p>
</blockquote>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126140755.png" class="lozad">





<h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><p>– 创建旅游线路分类表 tab_category<br>    – cid 旅游线路分类主键，自动增长<br>    – cname 旅游线路分类名称非空，唯一，字符串 100<br>    CREATE TABLE tab_category (<br>        cid INT PRIMARY KEY AUTO_INCREMENT,<br>        cname VARCHAR(100) NOT NULL UNIQUE<br>    );</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">-- 创建旅游线路表 tab_route</span><br><span class="line">/*</span><br><span class="line">rid 旅游线路主键，自动增长</span><br><span class="line">rname 旅游线路名称非空，唯一，字符串 100</span><br><span class="line">price 价格</span><br><span class="line">rdate 上架时间，日期类型</span><br><span class="line">cid 外键，所属分类</span><br><span class="line">*/</span><br><span class="line">CREATE TABLE tab_route(</span><br><span class="line">	rid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	rname VARCHAR(100) NOT NULL UNIQUE,</span><br><span class="line">	price DOUBLE,</span><br><span class="line">	rdate DATE,</span><br><span class="line">	cid INT,</span><br><span class="line">	FOREIGN KEY (cid) REFERENCES tab_category(cid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">/*创建用户表 tab_user</span><br><span class="line">uid 用户主键，自增长</span><br><span class="line">username 用户名长度 100，唯一，非空</span><br><span class="line">password 密码长度 30，非空</span><br><span class="line">name 真实姓名长度 100</span><br><span class="line">birthday 生日</span><br><span class="line">sex 性别，定长字符串 1</span><br><span class="line">telephone 手机号，字符串 11</span><br><span class="line">email 邮箱，字符串长度 100</span><br><span class="line">*/</span><br><span class="line">CREATE TABLE tab_user (</span><br><span class="line">	uid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	username VARCHAR(100) UNIQUE NOT NULL,</span><br><span class="line">	PASSWORD VARCHAR(30) NOT NULL,</span><br><span class="line">	NAME VARCHAR(100),</span><br><span class="line">	birthday DATE,</span><br><span class="line">	sex CHAR(1) DEFAULT &apos;男&apos;,</span><br><span class="line">	telephone VARCHAR(11),</span><br><span class="line">	email VARCHAR(100)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">创建收藏表 tab_favorite</span><br><span class="line">rid 旅游线路 id，外键</span><br><span class="line">date 收藏时间</span><br><span class="line">uid 用户 id，外键</span><br><span class="line">rid 和 uid 不能重复，设置复合主键，同一个用户不能收藏同一个线路两次</span><br><span class="line">*/</span><br><span class="line">CREATE TABLE tab_favorite (</span><br><span class="line">	rid INT, -- 线路id</span><br><span class="line">	DATE DATETIME,</span><br><span class="line">	uid INT, -- 用户id</span><br><span class="line">	-- 创建复合主键</span><br><span class="line">	PRIMARY KEY(rid,uid), -- 联合主键</span><br><span class="line">	FOREIGN KEY (rid) REFERENCES tab_route(rid),</span><br><span class="line">	FOREIGN KEY(uid) REFERENCES tab_user(uid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="数据库的设计准则——范式"><a href="#数据库的设计准则——范式" class="headerlink" title="数据库的设计准则——范式"></a>数据库的设计准则——范式</h2><p>设计数据库时，需要遵循的一些<strong>规范</strong></p>
<ul>
<li><p>设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式，</p>
</li>
<li><p>各种范式呈递次规范，越高的范式数据库冗余越小。</p>
<blockquote>
<p>目前关系数据库有六种范式：</p>
<pre><code>第一范式（1NF）、
第二范式（2NF）、
第三范式（3NF）、
巴斯-科德 范式（BCNF）、
第四范式(4NF）
第五范式（5NF，又称完美范式）。</code></pre></blockquote>
</li>
</ul>
<p><code>如果要遵循后边的范式要求，必须先遵循前边的所有范式要求</code></p>
<h3 id="1-第一范式（1NF）"><a href="#1-第一范式（1NF）" class="headerlink" title="(1) 第一范式（1NF）"></a>(1) 第一范式（1NF）</h3><p>每一列都是不可分割的原子数据项</p>
<img style="zoom: 50%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126143429.png" class="lozad">



<blockquote>
<p>存在的问题：<br>    1.存在非常严重的数据冗余(重复)：姓名、系名、系主任<br>    2.数据添加存在问题：添加新开设的系和系主任时，数据不合法<br>    3.数据删除存在问题：张无忌同学毕业了，删除数据，会将系的数据一起删除。</p>
</blockquote>
<h3 id="2-第二范式（2NF）"><a href="#2-第二范式（2NF）" class="headerlink" title="(2) 第二范式（2NF）"></a>(2) 第二范式（2NF）</h3><p>​    在1NF的基础上，非码属性必须完全依赖于码（<code>在1NF基础上消除</code>非主属性对主码的<code>部分函数依赖</code>）</p>
<p>​    首先要介绍几个概念：</p>
<ol>
<li><strong>函数依赖</strong>：A–&gt;B,如果通过A属性(属性组)的值，可以确定唯一B属性的值。则称B依赖于A<br>例如：学号–&gt;姓名。  （学号，课程名称） –&gt; 分数</li>
<li><strong>完全函数依赖</strong>：A–&gt;B， 如果A是一个属性组，则B属性值得确定需要依赖于A属性组中所有的属性值。<br>例如：（学号，课程名称） –&gt; 分数</li>
<li><strong>部分函数依赖</strong>：A–&gt;B， 如果A是一个属性组，则B属性值得确定只需要依赖于A属性组中某一些值即可。<br>例如：（学号，课程名称） – &gt; 姓名</li>
<li><strong>传递函数依赖</strong>：A–&gt;B, B – &gt;C . 如果通过A属性(属性组)的值，可以确定唯一B属性的值，在通过B属性（属性组）的值可以确定唯一C属性的值，则称 C 传递函数依赖于A<br>例如：学号–&gt;系名，系名–&gt;系主任</li>
<li><strong>码</strong>：如果在一张表中，一个属性或属性组，被其他所有属性所完全依赖，则称这个属性(属性组)为该表的码<br>例如：该表中码为：（学号，课程名称）<ul>
<li>主属性：码属性组中的所有属性</li>
<li>非主属性：除过码属性组的属性</li>
</ul>
</li>
</ol>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126145738.png" class="lozad"></p>
<blockquote>
<p>本例中，</p>
<p>​        码属性组（学号，课程名称），</p>
<p>​        分数完全依赖于码，</p>
<p>​        而姓名、系名和系主任则部分依赖于码（只需学号就可确定）；</p>
<p>而2NF的任务就是消除部分依赖</p>
<p>那么如何消除？方法就是拆分表格</p>
</blockquote>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126151257.png" class="lozad">        

<blockquote>
<p>依然存在的问题：</p>
<p>​    2.数据添加存在问题：添加新开设的系和系主任时，数据不合法<br>​    3.数据删除存在问题：张无忌同学毕业了，删除数据，会将系的数据一起删除。</p>
</blockquote>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126151802.png" class="lozad">







<h3 id="3-第三范式（3NF）"><a href="#3-第三范式（3NF）" class="headerlink" title="(3) 第三范式（3NF）"></a>(3) 第三范式（3NF）</h3><p>​    在2NF基础上，任何非主属性不依赖于其它非主属性（<code>在2NF基础上消除传递依赖</code>）</p>
<p>​    本例中的传递依赖是：学号 – &gt; 系名 –&gt; 系主任</p>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126152008.png" class="lozad">



<p>此时添加数据和删除数据就都合法了。</p>
<h1 id="DQL-1"><a href="#DQL-1" class="headerlink" title="DQL"></a>DQL</h1><h2 id="单表查询"><a href="#单表查询" class="headerlink" title="单表查询"></a>单表查询</h2><h2 id="–-1-基础查询"><a href="#–-1-基础查询" class="headerlink" title="– (1) 基础查询"></a>– (1) 基础查询</h2><blockquote>
<p>SELECT  FROM,DISTINCT , IFNULL, AS</p>
</blockquote>
<ul>
<li><p>查询 student 表所有字段<br> <code>select * from student;</code></p>
</li>
<li><p>查询 NAME 和 age 两列<br> <code>select NAME,age from student;</code></p>
</li>
<li><p>查询地址（去除重复后的结果集）<br> <code>select DISTINCT address from student;</code></p>
</li>
<li><p>计算分数之和（新列）</p>
<p><code>select name, math, english,math+english from student;</code></p>
<ul>
<li><p>若有null参与运算，则结果为null，显然不合理，这里应该用到：</p>
</li>
<li><p>IFNULL（字段名，字段值）：如果字段名的默认值为null，那么该值就替换为字段值</p>
<p><code>SELECT name,math,english,math+IFNULL(english,0) FROM student;</code></p>
</li>
</ul>
</li>
<li><p>起别名（接上例）（as 可省略）</p>
<p><code>SELECT name as 姓名,math as 数学,english as 英语,math+IFNULL(english,0) as 总分 FROM student;</code></p>
</li>
</ul>
<h2 id="–-2-条件查询"><a href="#–-2-条件查询" class="headerlink" title="– (2) 条件查询"></a>– (2) 条件查询</h2><blockquote>
<p>WHERE，BETWEEN AND， IN，IS NULL， AND，OR，NOT</p>
</blockquote>
<ul>
<li><p>查询 age等于20 的人</p>
<p><code>SELECT name,age FROM student WHERE age=20;</code></p>
</li>
<li><p>查询 age不等于20 的人</p>
<p><code>SELECT name,age FROM student WHERE age!=20;</code></p>
<p><code>SELECT name,age FROM student WHERE age&lt;&gt;20;</code></p>
</li>
<li><p>查询 age在[20,30] 范围的人</p>
<p><code>SELECT name,age FROM student WHERE age&gt;=20 AND age&lt;=30;</code></p>
<p> <code>SELECT name,age FROM student WHERE age BETWEEN 20 AND 30;</code> </p>
</li>
<li><p>查询 age等于22 或 18 或 25 的人</p>
<p><code>SELECT name,age FROM student WHERE age=22 OR age=18 OR age=25;</code></p>
<p><code>SELECT name,age FROM student WHERE age IN(18,22,25);</code></p>
<p>查询 English 缺考的人（=null）和未缺考的人</p>
<p><code>SELECT name,english FROM student WHERE english IS NULL;</code></p>
<p><code>SELECT name,english FROM student WHERE english IS NOT NULL;</code></p>
</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td>LIKE （模糊查询）</td>
<td align="left">占位符<br> _：单个任意字符<br>%：多个任意字符</td>
</tr>
</tbody></table>
<ul>
<li><p>查询姓名中包含马的人</p>
<p><code>SELECT name FROM student WHERE name LIKE &#39;%马%&#39;;</code></p>
</li>
<li><p>查询姓名是3个字的人</p>
<p><code>SELECT name FROM student WHERE name LIKE &#39;___&#39;;</code></p>
</li>
</ul>
<h2 id="–-3-排序查询"><a href="#–-3-排序查询" class="headerlink" title="– (3) 排序查询"></a>– (3) 排序查询</h2><blockquote>
<p>ORDER BY ASC / DESC（默认升序）</p>
</blockquote>
<ul>
<li><p>按照 math 升序排序</p>
<p><code>SELECT name,math,english FROM student ORDER BY math asc;</code></p>
</li>
<li><p>按照 math 升序排序，若 math 一样，则按照 english 升序排序</p>
<p><code>SELECT name,math,english FROM student ORDER BY math asc,english asc;</code></p>
</li>
</ul>
<h2 id="–-4-计算列（聚合函数）"><a href="#–-4-计算列（聚合函数）" class="headerlink" title="– (4) 计算列（聚合函数）"></a>– (4) 计算列（聚合函数）</h2><blockquote>
<p>COUNT，MAX，MIN，SUM，AVG</p>
</blockquote>
<p>注意：聚合函数不计算null值</p>
<ul>
<li><p>查询总人数</p>
<p><code>SELECT COUNT(name),COUNT(IFNULL(english,0)) FROM student;</code></p>
</li>
<li><p>查询 math 的最大值和最小值</p>
<p><code>SELECT MAX(math),MIN(math) FROM student;</code></p>
</li>
<li><p>查询 english 的总和 以及 english 的平均值</p>
<p><code>SELECT SUM(english),AVG(english) FROM student;</code></p>
</li>
</ul>
<h2 id="–-5-分组查询"><a href="#–-5-分组查询" class="headerlink" title="– (5) 分组查询"></a>– (5) 分组查询</h2><blockquote>
<p>GROUP BY，HAVING（分组之后查询的字段为：分组字段、聚合函数)</p>
</blockquote>
<blockquote>
<p> where 和 having 的区别？</p>
<ol>
<li>where 在分组之前进行限定，having 在分组之后进行限定</li>
<li>where后不能根聚合函数，having后可以更聚合函数</li>
</ol>
</blockquote>
<ul>
<li><p>按照性别分组，查询不同性别的 english 的平均分，人数（分数低于70的人不参与分组）</p>
<p><code>SELECT sex,AVG(english),COUNT(id) FROM student WHERE english&gt;70 GROUP BY sex</code></p>
</li>
<li><p>根据上述分组，只显示大于2人的分组</p>
<p><code>SELECT sex,AVG(english),COUNT(id) FROM student WHERE english&gt;70 GROUP BY sex HAVING COUNT(id)&gt;2;</code></p>
</li>
</ul>
<h2 id="–-6-分页查询"><a href="#–-6-分页查询" class="headerlink" title="– (6) 分页查询"></a>– (6) 分页查询</h2><blockquote>
<p>LIMIT x,y  —–  从 x 开始显示 y 条记录</p>
</blockquote>
<ul>
<li><p>每页显示3条记录</p>
<p><code>SELECT * FROM student LIMIT 0,3;</code></p>
<p><code>SELECT * FROM student LIMIT 3,3;</code></p>
<p><code>SELECT * FROM student LIMIT 6,3;</code></p>
</li>
</ul>
<h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><p>先创建2张表：部门表 + 员工表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建部门表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept(</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">	<span class="keyword">NAME</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept (<span class="keyword">NAME</span>) <span class="keyword">VALUES</span> (<span class="string">'开发部'</span>),(<span class="string">'市场部'</span>),(<span class="string">'财务部'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建员工表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp (</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">	<span class="keyword">NAME</span> <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	gender <span class="built_in">CHAR</span>(<span class="number">1</span>), <span class="comment">-- 性别</span></span><br><span class="line">	salary <span class="keyword">DOUBLE</span>, <span class="comment">-- 工资</span></span><br><span class="line">	join_date <span class="built_in">DATE</span>, <span class="comment">-- 入职日期</span></span><br><span class="line">	dept_id <span class="built_in">INT</span>,</span><br><span class="line">	<span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (dept_id) <span class="keyword">REFERENCES</span> dept(<span class="keyword">id</span>) <span class="comment">-- 外键，关联部门表(部门表的主键)</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(<span class="keyword">NAME</span>,gender,salary,join_date,dept_id) <span class="keyword">VALUES</span>(<span class="string">'孙悟空'</span>,<span class="string">'男'</span>,<span class="number">7200</span>,<span class="string">'2013-02-24'</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(<span class="keyword">NAME</span>,gender,salary,join_date,dept_id) <span class="keyword">VALUES</span>(<span class="string">'猪八戒'</span>,<span class="string">'男'</span>,<span class="number">3600</span>,<span class="string">'2010-12-02'</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(<span class="keyword">NAME</span>,gender,salary,join_date,dept_id) <span class="keyword">VALUES</span>(<span class="string">'唐僧'</span>,<span class="string">'男'</span>,<span class="number">9000</span>,<span class="string">'2008-08-08'</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(<span class="keyword">NAME</span>,gender,salary,join_date,dept_id) <span class="keyword">VALUES</span>(<span class="string">'白骨精'</span>,<span class="string">'女'</span>,<span class="number">5000</span>,<span class="string">'2015-10-07'</span>,<span class="number">3</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp(<span class="keyword">NAME</span>,gender,salary,join_date,dept_id) <span class="keyword">VALUES</span>(<span class="string">'蜘蛛精'</span>,<span class="string">'女'</span>,<span class="number">4500</span>,<span class="string">'2011-03-14'</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>多表查询涉及到了笛卡尔积：</p>
<h3 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h3><blockquote>
<ul>
<li>有两个集合A,B .取这两个集合的所有组成情况。</li>
<li>要完成多表查询，需要<strong>消除无用的数据</strong></li>
<li>多表查询的分类：<strong>内连接查询 + 外连接查询</strong></li>
</ul>
</blockquote>
<h4 id="1-内连接查询"><a href="#1-内连接查询" class="headerlink" title="(1) 内连接查询"></a>(1) 内连接查询</h4><blockquote>
<p>使用内连接查询需要的数据：</p>
<ol>
<li>查询哪些字段( select … )</li>
<li>从哪些表中查询数据 ( from… )</li>
<li>条件是什么( where… )</li>
</ol>
</blockquote>
<ul>
<li><p><strong>隐式内连接</strong>：使用 <strong>where</strong> 条件消除无用数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有员工信息和对应的部门信息</span></span><br><span class="line">	<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp,dept <span class="keyword">WHERE</span> emp.<span class="string">`dept_id`</span> = dept.<span class="string">`id`</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">-- 查询员工表的名称，性别。部门表的名称</span></span><br><span class="line">	<span class="comment">-- 方式1</span></span><br><span class="line">	<span class="keyword">SELECT</span> emp.name,emp.gender,dept.name <span class="keyword">FROM</span> emp,dept <span class="keyword">WHERE</span> emp.<span class="string">`dept_id`</span> = dept.<span class="string">`id`</span>;</span><br><span class="line">	<span class="comment">-- 方式2</span></span><br><span class="line">	<span class="keyword">SELECT</span> </span><br><span class="line">		t1.name, <span class="comment">-- 员工表的姓名</span></span><br><span class="line">		t1.gender,<span class="comment">-- 员工表的性别</span></span><br><span class="line">		t2.name <span class="comment">-- 部门表的名称</span></span><br><span class="line">	<span class="keyword">FROM</span></span><br><span class="line">		emp t1,</span><br><span class="line">		dept t2</span><br><span class="line">	<span class="keyword">WHERE</span> </span><br><span class="line">		t1.<span class="string">`dept_id`</span> = t2.<span class="string">`id`</span>;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p><strong>显式内连接：</strong></p>
<p>语法： <code>select 字段列表 from 表名1 [inner] join 表名2 on 条件</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有员工信息和对应的部门信息</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">INNER</span> <span class="keyword">JOIN</span> dept <span class="keyword">ON</span> emp.<span class="string">`dept_id`</span> = dept.<span class="string">`id`</span>;	</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">JOIN</span> dept <span class="keyword">ON</span> emp.<span class="string">`dept_id`</span> = dept.<span class="string">`id`</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>​    </p>
<h4 id="2-外连接查询"><a href="#2-外连接查询" class="headerlink" title="(2) 外连接查询"></a>(2) 外连接查询</h4><ul>
<li><p><strong>左外连接：</strong>查询的是左表所有数据以及其交集部分。</p>
<p>语法：<code>select 字段列表 from 表1 left [outer] join 表2 on 条件；</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有员工信息，如果员工有部门，则查询部门名称，没有部门，则不显示部门名称</span></span><br><span class="line"><span class="keyword">SELECT</span> t1.*,t2.<span class="string">`name`</span> <span class="keyword">FROM</span> emp t1 <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> dept t2 <span class="keyword">ON</span> t1.<span class="string">`dept_id`</span> = t2.<span class="string">`id`</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126154358.png" class="lozad">

<ul>
<li><p><strong>右外连接：</strong>查询的是右表所有数据以及其交集部分。</p>
<p>语法：<code>select 字段列表 from 表1 right [outer] join 表2 on 条件;</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有员工信息，如果员工有部门，则查询部门名称，没有部门，则不显示部门名称</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> dept t2 <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> emp t1 <span class="keyword">ON</span> t1.<span class="string">`dept_id`</span> = t2.<span class="string">`id`</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="3-子查询（嵌套查询）"><a href="#3-子查询（嵌套查询）" class="headerlink" title="(3) 子查询（嵌套查询）"></a>(3) 子查询（嵌套查询）</h4><ul>
<li><p>概念：查询中嵌套查询，称<strong>嵌套查询</strong>为<strong>子查询</strong>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询工资最高的员工信息</span></span><br><span class="line"><span class="comment"># 普通方法</span></span><br><span class="line"><span class="comment">-- 1 查询最高的工资是多少 9000</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(salary) <span class="keyword">FROM</span> emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2 查询员工信息，并且工资等于9000的</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> emp.<span class="string">`salary`</span> = <span class="number">9000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 子查询方法</span></span><br><span class="line"><span class="comment">-- 一条sql就完成这个操作。子查询</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> emp.<span class="string">`salary`</span> = (<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(salary) <span class="keyword">FROM</span> emp);</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><strong>子查询不同情况</strong></li>
</ul>
<pre><code>1. 子查询的结果是**单行单列**的：子查询可以作为条件，使用**运算符**去判断。 运算符： &gt; &gt;= &lt; &lt;= =
    <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工工资小于平均工资的人</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> emp.salary &lt; (<span class="keyword">SELECT</span> <span class="keyword">AVG</span>(salary) <span class="keyword">FROM</span> emp);</span><br></pre></td></tr></table></figure>




2. 子查询的结果是**多行单列**的：子查询可以作为条件，使用**运算符in**来判断

  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询'财务部'和'市场部'所有的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> dept <span class="keyword">WHERE</span> <span class="keyword">NAME</span> = <span class="string">'财务部'</span> <span class="keyword">OR</span> <span class="keyword">NAME</span> = <span class="string">'市场部'</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> dept_id = <span class="number">3</span> <span class="keyword">OR</span> dept_id = <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 子查询</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> dept_id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> dept <span class="keyword">WHERE</span> <span class="keyword">NAME</span> = <span class="string">'财务部'</span> <span class="keyword">OR</span> <span class="keyword">NAME</span> = <span class="string">'市场部'</span>);</span><br></pre></td></tr></table></figure>




3. 子查询的结果是**多行多列**的：子查询可以作为一张**虚拟表**参与查询

  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工入职日期是2011-11-11日之后的员工信息和部门信息</span></span><br><span class="line"><span class="comment">-- 子查询</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> dept t1 ,(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> emp.<span class="string">`join_date`</span> &gt; <span class="string">'2011-11-11'</span>) t2</span><br><span class="line"><span class="keyword">WHERE</span> t1.id = t2.dept_id;</span><br><span class="line"><span class="comment">-- 普通内连接</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> emp t1,dept t2 <span class="keyword">WHERE</span> t1.<span class="string">`dept_id`</span> = t2.<span class="string">`id`</span> <span class="keyword">AND</span> t1.<span class="string">`join_date`</span> &gt;  <span class="string">'2011-11-11'</span>;</span><br></pre></td></tr></table></figure></code></pre><h1 id="数据库的备份和还原"><a href="#数据库的备份和还原" class="headerlink" title="数据库的备份和还原"></a>数据库的备份和还原</h1><ol>
<li>命令行：<ul>
<li>语法：<ul>
<li>备份： <code>mysqldump -u用户名 -p密码 数据库名称 &gt; 保存的路径</code></li>
<li>还原：<ol>
<li>登录数据库</li>
<li>创建数据库</li>
<li>使用数据库</li>
<li>执行文件 source 文件路径</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li>图形化工具：</li>
</ol>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><h2 id="概念-步骤"><a href="#概念-步骤" class="headerlink" title="概念 + 步骤"></a>概念 + 步骤</h2><p><strong>事务</strong>：如果一个包含多个步骤的业务操作，被事务管理，那么这些操作要么同时成功，要么同时失败。</p>
<p><strong>操作步骤：</strong></p>
<ol>
<li>开启事务： start transaction;</li>
<li>回滚：rollback;</li>
<li>提交：commit;</li>
</ol>
<ul>
<li><p>先创建一张表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">account</span> (</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</span><br><span class="line">	<span class="keyword">NAME</span> <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	balance <span class="keyword">DOUBLE</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加数据</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">account</span> (<span class="keyword">NAME</span>, balance) <span class="keyword">VALUES</span> (<span class="string">'zhangsan'</span>, <span class="number">1000</span>), (<span class="string">'lisi'</span>, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<img style="zoom:80%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126161100.png" class="lozad">

<ul>
<li><p>模拟转账出错：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 张三账户 -500</span></span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">account</span> <span class="keyword">SET</span> balance = balance - <span class="number">500</span> <span class="keyword">WHERE</span> <span class="keyword">NAME</span> = <span class="string">'zhangsan'</span>;</span><br><span class="line"><span class="comment">-- 2. 李四账户 +500（多打了一行字，导致出错，下条没执行）</span></span><br><span class="line">多打了一行字</span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">account</span> <span class="keyword">SET</span> balance = balance + <span class="number">500</span> <span class="keyword">WHERE</span> <span class="keyword">NAME</span> = <span class="string">'lisi'</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<img style="zoom:80%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126160834.png" class="lozad">

<ul>
<li><p>使用事务解决：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--    先恢复金额</span></span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">account</span> <span class="keyword">SET</span> balance = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 0. 开启事务</span></span><br><span class="line"><span class="keyword">START</span> <span class="keyword">TRANSACTION</span>;</span><br><span class="line"><span class="comment">-- 1. 张三账户 -500</span></span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">account</span> <span class="keyword">SET</span> balance = balance - <span class="number">500</span> <span class="keyword">WHERE</span> <span class="keyword">NAME</span> = <span class="string">'zhangsan'</span>;</span><br><span class="line"><span class="comment">-- 2. 李四账户 +500（多打了一行字，导致出错）</span></span><br><span class="line">多打了一行字</span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">account</span> <span class="keyword">SET</span> balance = balance + <span class="number">500</span> <span class="keyword">WHERE</span> <span class="keyword">NAME</span> = <span class="string">'lisi'</span>;</span><br><span class="line">	</span><br><span class="line"><span class="comment">-- 发现执行没有问题，提交事务</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line">	</span><br><span class="line"><span class="comment">-- 发现出问题了，回滚事务</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<img style="zoom:80%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126161100.png" class="lozad">



<h2 id="事务提交的两种方式"><a href="#事务提交的两种方式" class="headerlink" title="事务提交的两种方式"></a>事务提交的两种方式</h2><p>自动提交：一条DML(增删改)语句会自动提交一次事务。（mysql就是自动提交的）</p>
<p>手动提交：需要先开启事务，再提交</p>
<ul>
<li>（<strong>若只开启事务没有提交，则下次重新打开图形界面时会恢复成之之前的数据</strong>）</li>
<li>（上述例子就是手动提交的）</li>
</ul>
<blockquote>
<p> MySQL数据库中事务默认自动提交，Oracle 数据库默认是手动提交事务</p>
</blockquote>
<blockquote>
<p>修改事务的默认提交方式：</p>
<ul>
<li>查看事务的默认提交方式：SELECT @@autocommit; – 1 代表自动提交  0 代表手动提交</li>
<li>修改默认提交方式： set @@autocommit = 0;</li>
</ul>
</blockquote>
<h2 id="事务的四大特征（⭐）"><a href="#事务的四大特征（⭐）" class="headerlink" title="事务的四大特征（⭐）"></a>事务的四大特征（⭐）</h2><ol>
<li>原子性：是不可分割的最小操作单位，要么同时成功，要么同时失败。</li>
<li>持久性：当事务提交或回滚后，数据库会持久化的保存数据。</li>
<li>隔离性：多个事务之间。相互独立。</li>
<li>一致性：事务操作前后，数据总量不变</li>
</ol>
<h2 id="事务的隔离级别（⭐）"><a href="#事务的隔离级别（⭐）" class="headerlink" title="事务的隔离级别（⭐）"></a>事务的隔离级别（⭐）</h2><ul>
<li><p>概念：多个事务之间隔离的，相互独立的。但是如果多个事务操作同一批数据，则会引发一些问题，设置不同的隔离级别就可以解决这些问题。</p>
</li>
<li><p>存在的问题：</p>
<ol>
<li><strong>脏读</strong>：一个事务，读取到另一个事务中没有提交的数据</li>
<li><strong>不可重复读(虚读)</strong>：在同一个事务中，两次读取到的数据不一样。</li>
<li><strong>幻读</strong>：一个事务操作(DML)数据表中所有记录，另一个事务添加了一条数据，则第一个事务查询不到自己的修改。</li>
</ol>
</li>
<li><p>隔离级别：</p>
<ol>
<li><p>read uncommitted：读未提交（对方事务<strong>未提交</strong>，我方事务就可读取到修改）</p>
<ul>
<li>产生的问题：脏读、不可重复读、幻读</li>
</ul>
</li>
<li><p>read committed：读已提交 （对方事务<strong>提交后</strong>，我方事务才能读取到修改）（Oracle默认）</p>
<ul>
<li>产生的问题：不可重复读、幻读</li>
</ul>
</li>
<li><p>repeatable read：可重复读 （对方和我方事务<strong>都提交后</strong>，我方事务才能读取到修改）（MySQL默认）</p>
<ul>
<li>产生的问题：幻读</li>
</ul>
</li>
<li><p>serializable：串行化（<strong>锁表</strong>的操作，只能有一个事务在运行，相当于java的同步锁）</p>
<ul>
<li>可以解决所有的问题</li>
</ul>
<blockquote>
<p>注意：隔离级别从小到大<strong>安全性越来越高</strong>，但是<strong>效率越来越低</strong></p>
</blockquote>
<blockquote>
<p>数据库查询隔离级别：select @@tx_isolation;</p>
<p>数据库设置隔离级别：set global transaction isolation level  级别字符串;<strong>（修改隔离级别后要重启）</strong></p>
</blockquote>
</li>
</ol>
</li>
<li><p>案例演示：</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询隔离级别</span></span><br><span class="line"><span class="keyword">select</span> @@tx_isolation;</span><br><span class="line"><span class="comment">-- 设置隔离级别</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> <span class="keyword">read</span> uncommitted;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 开启事务</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>;</span><br><span class="line"><span class="comment">-- 转账操作</span></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">account</span> <span class="keyword">set</span> balance = balance - <span class="number">500</span> <span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">account</span> <span class="keyword">set</span> balance = balance + <span class="number">500</span> <span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 事务提交</span></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"><span class="comment">-- 事务回滚</span></span><br><span class="line"><span class="keyword">rollback</span>;</span><br></pre></td></tr></table></figure>




</li>
</ul>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126164808.png" class="lozad"></p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126170106.png" class="lozad"></p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126171402.png" class="lozad"></p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126172242.png" class="lozad"></p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126172450.png" class="lozad"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">杨涵</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://cometorbityh.github.io/2019/11/25/数据库/">https://cometorbityh.github.io/2019/11/25/数据库/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://cometorbityh.github.io">MY</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MYSQL/">MYSQL    </a><a class="post-meta__tags" href="/tags/数据库/">数据库    </a></div><div class="post_share"><div class="social-share" data-image="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191126231814.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/2019/11/26/JAVA-多线程：1/"><img class="prev_cover lozad" data-src="undefined" onerror="onerror=null;src='/img/comment_bg.png'"><div class="label">上一篇</div><div class="prev_info"><span>JAVA 多线程：1</span></div></a></div><div class="next-post pull-right"><a href="/2019/11/24/JAVA-集合：Collections/"><img class="next_cover lozad" data-src="undefined" onerror="onerror=null;src='/img/comment_bg.png'"><div class="label">下一篇</div><div class="next_info"><span>JAVA 集合：Collections</span></div></a></div></nav></div></div><footer><div id="footer"><div class="copyright">&copy;2018 - 2019 By 杨涵</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="nightshift fa fa-moon-o" id="nightshift" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/nightshift.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script>const observer = lozad(); // lazy loads elements with default selector as '.lozad'
observer.observe();
</script></body></html>