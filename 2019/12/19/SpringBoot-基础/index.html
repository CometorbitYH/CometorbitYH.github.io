<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>SpringBoot 基础 | MY</title><meta name="description" content="SpringBoot 基础"><meta name="keywords" content><meta name="author" content="杨涵"><meta name="copyright" content="杨涵"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://cometorbityh.github.io/2019/12/19/SpringBoot-基础/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="SpringBoot 基础"><meta name="twitter:description" content="SpringBoot 基础"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png"><meta property="og:type" content="article"><meta property="og:title" content="SpringBoot 基础"><meta property="og:url" content="https://cometorbityh.github.io/2019/12/19/SpringBoot-基础/"><meta property="og:site_name" content="MY"><meta property="og:description" content="SpringBoot 基础"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="记录学习python遇到的一些问题(坑)" href="https://cometorbityh.github.io/2019/12/25/记录学习python遇到的一些问题-坑/"><link rel="next" title="MYSQL高级篇" href="https://cometorbityh.github.io/2019/12/18/MYSQL高级篇/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: {"languages":{"author":"作者: 杨涵","link":"链接: https://cometorbityh.github.io/2019/12/19/SpringBoot-基础/","source":"来源: MY","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  copy_copyright_js: true
  
}</script></head><body><canvas class="fireworks"></canvas><div id="header"> <div id="page-header"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">MY</a></span><i class="fa fa-bars fa-fw toggle-menu pull-right close" aria-hidden="true"></i><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right" id="search_button"></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lozad avatar_img" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">69</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">16</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">9</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【重要】SpringBoot的启动分析"><span class="toc_mobile_items-text">【重要】SpringBoot的启动分析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【了解】SpringBoot热部署-Lombok"><span class="toc_mobile_items-text">【了解】SpringBoot热部署 + Lombok</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#————————"><span class="toc_mobile_items-text">————————-</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【掌握】SpringBoot的2种配置文件语法"><span class="toc_mobile_items-text">【掌握】SpringBoot的2种配置文件语法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-properties-yml"><span class="toc_mobile_items-text">(1) properties + yml</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-配置文件占位符"><span class="toc_mobile_items-text">(2) 配置文件占位符</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【掌握】常用注解"><span class="toc_mobile_items-text">【掌握】常用注解</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-propertySource"><span class="toc_mobile_items-text">(1) @propertySource</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-ImportRouurce"><span class="toc_mobile_items-text">(2) @ImportRouurce</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-Bean"><span class="toc_mobile_items-text">(3) @Bean</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-Value"><span class="toc_mobile_items-text">(4) @Value</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【掌握】profiles配置详解【切换环境】"><span class="toc_mobile_items-text">【掌握】profiles配置详解【切换环境】</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-开发环境与生产环境"><span class="toc_mobile_items-text">(1) 开发环境与生产环境</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-application-profile-properties：作用在全局"><span class="toc_mobile_items-text">(2) application-{profile}.properties：作用在全局</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-Profile：作用在类或方法上"><span class="toc_mobile_items-text">(3) @Profile：作用在类或方法上</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-yml文件的多配置块的集成切换"><span class="toc_mobile_items-text">(4) yml文件的多配置块的集成切换</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【掌握】配置文件的优先级-和-外部配置文件加载"><span class="toc_mobile_items-text">【掌握】配置文件的优先级 和 外部配置文件加载</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-项目内部配置文件的优先级"><span class="toc_mobile_items-text">(1) 项目内部配置文件的优先级</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-外部配置文件"><span class="toc_mobile_items-text">(2) 外部配置文件</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#————————-1"><span class="toc_mobile_items-text">————————-</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【重点】自动配置原理-Conditional"><span class="toc_mobile_items-text">【重点】自动配置原理 + @Conditional</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-自动配置原理"><span class="toc_mobile_items-text">(1) 自动配置原理</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-Conditional"><span class="toc_mobile_items-text">(2) @Conditional</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#————————-2"><span class="toc_mobile_items-text">————————-</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【掌握】Web静态资源的访问规则【直接访问】"><span class="toc_mobile_items-text">【掌握】Web静态资源的访问规则【直接访问】</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-静态资源的访问优先级"><span class="toc_mobile_items-text">(1) 静态资源的访问优先级</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-静态资源加载原理"><span class="toc_mobile_items-text">(2) 静态资源加载原理</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-自定义静态资源路径"><span class="toc_mobile_items-text">(3) 自定义静态资源路径</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-webjars的访问配置"><span class="toc_mobile_items-text">(4) webjars的访问配置</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【掌握】thymeleaf【间接访问-跳转】"><span class="toc_mobile_items-text">【掌握】thymeleaf【间接访问_跳转】</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-thymeleaf的文件存放位置-访问"><span class="toc_mobile_items-text">(1) thymeleaf的文件存放位置 + 访问</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-thymeleaf-包在-SpringBoot-的位置"><span class="toc_mobile_items-text">(1-1) thymeleaf 包在 SpringBoot 的位置</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-访问静态资源"><span class="toc_mobile_items-text">(1-2) 访问静态资源</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-3-原理"><span class="toc_mobile_items-text">(1-3) 原理</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-4-yml修改thymeleaf的文件位置"><span class="toc_mobile_items-text">(1-4) yml修改thymeleaf的文件位置</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-thymeleaf的基本使用"><span class="toc_mobile_items-text">(2) thymeleaf的基本使用</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-引入命名空间"><span class="toc_mobile_items-text">(2-1) 引入命名空间</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-2-使用占位符获取数据"><span class="toc_mobile_items-text">(2-2) 使用占位符获取数据</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-3-实例"><span class="toc_mobile_items-text">(2-3) 实例</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【掌握】AOP开发"><span class="toc_mobile_items-text">【掌握】AOP开发</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【掌握】管理-扩展-SpringMVC组件"><span class="toc_mobile_items-text">【掌握】管理 + 扩展 SpringMVC组件</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-管理SpringMVC组件"><span class="toc_mobile_items-text">(1) 管理SpringMVC组件</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-使用springmvc时要配置的组件"><span class="toc_mobile_items-text">(1-1) 使用springmvc时要配置的组件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-springboot自动管理springmvc的源码分析"><span class="toc_mobile_items-text">(1-2) springboot自动管理springmvc的源码分析</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#lt-1-gt-前端控制器的自动管理"><span class="toc_mobile_items-text">&lt;1&gt;  前端控制器的自动管理</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#找到WebMvcAutoConfiguration"><span class="toc_mobile_items-text">找到WebMvcAutoConfiguration</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#打开DispatcherServletAutoConfiguration"><span class="toc_mobile_items-text">打开DispatcherServletAutoConfiguration</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#lt-2-gt-控制器的自动管理【自定义的-Controller】"><span class="toc_mobile_items-text">&lt;2&gt; 控制器的自动管理【自定义的 Controller】</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#自动扫描"><span class="toc_mobile_items-text">自动扫描</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#若不在启动类所在包及其子包下"><span class="toc_mobile_items-text">若不在启动类所在包及其子包下</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#lt-3-gt-视图解析器的自动管理"><span class="toc_mobile_items-text">&lt;3&gt; 视图解析器的自动管理</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#找到WebMvcAutoConfiguration-1"><span class="toc_mobile_items-text">找到WebMvcAutoConfiguration</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#进入-ContentNegotiatingViewResolver"><span class="toc_mobile_items-text">进入 ContentNegotiatingViewResolver</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#自定义前缀和后缀"><span class="toc_mobile_items-text">自定义前缀和后缀</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#lt-4-gt-文件上传"><span class="toc_mobile_items-text">&lt;4&gt; 文件上传</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#打开-MultipartAutoConfiguration"><span class="toc_mobile_items-text">打开 MultipartAutoConfiguration</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#打开-MultipartProperties"><span class="toc_mobile_items-text">打开 MultipartProperties</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#lt-5-gt-静态资源的访问"><span class="toc_mobile_items-text">&lt;5&gt; 静态资源的访问</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#lt-6-gt-欢迎页面"><span class="toc_mobile_items-text">&lt;6&gt; 欢迎页面</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#lt-7-gt-消息转化"><span class="toc_mobile_items-text">&lt;7&gt; 消息转化</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#lt-8-gt-格式化转化"><span class="toc_mobile_items-text">&lt;8&gt; 格式化转化</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-扩展SpringMVC组件"><span class="toc_mobile_items-text">(2) 扩展SpringMVC组件</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-在容器中注册视图控制器【页面跳转】"><span class="toc_mobile_items-text">(2-1) 在容器中注册视图控制器【页面跳转】</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#通过控制器跳转"><span class="toc_mobile_items-text">通过控制器跳转</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#通过配置类跳转"><span class="toc_mobile_items-text">通过配置类跳转</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-2-日期格式化"><span class="toc_mobile_items-text">(2-2) 日期格式化</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-3-自定义格式化器"><span class="toc_mobile_items-text">(2-3) 自定义格式化器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-4-拦截器"><span class="toc_mobile_items-text">(2-4) 拦截器</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【难点】内嵌web服务器的加载原理"><span class="toc_mobile_items-text">【难点】内嵌web服务器的加载原理</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-tomcat启动分析"><span class="toc_mobile_items-text">(1) tomcat启动分析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-启动内嵌Jetty服务器"><span class="toc_mobile_items-text">(2) 启动内嵌Jetty服务器</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#修改pom-xml"><span class="toc_mobile_items-text">修改pom.xml</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#启动"><span class="toc_mobile_items-text">启动</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#【掌握】Web三大组件的注册"><span class="toc_mobile_items-text">【掌握】Web三大组件的注册</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#回顾"><span class="toc_mobile_items-text">回顾</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#servlet"><span class="toc_mobile_items-text">servlet</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Filter"><span class="toc_mobile_items-text">Filter</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#Listener"><span class="toc_mobile_items-text">Listener</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#注册"><span class="toc_mobile_items-text">注册</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#注册Servlet"><span class="toc_mobile_items-text">注册Servlet</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#注册Filter"><span class="toc_mobile_items-text">注册Filter</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#注册Listener"><span class="toc_mobile_items-text">注册Listener</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#监听器的分类"><span class="toc_mobile_items-text">监听器的分类</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#过程"><span class="toc_mobile_items-text">过程</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div id="body-wrap"><div id="web_bg"></div><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#【重要】SpringBoot的启动分析"><span class="toc-text">【重要】SpringBoot的启动分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【了解】SpringBoot热部署-Lombok"><span class="toc-text">【了解】SpringBoot热部署 + Lombok</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#————————"><span class="toc-text">————————-</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【掌握】SpringBoot的2种配置文件语法"><span class="toc-text">【掌握】SpringBoot的2种配置文件语法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-properties-yml"><span class="toc-text">(1) properties + yml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-配置文件占位符"><span class="toc-text">(2) 配置文件占位符</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【掌握】常用注解"><span class="toc-text">【掌握】常用注解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-propertySource"><span class="toc-text">(1) @propertySource</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-ImportRouurce"><span class="toc-text">(2) @ImportRouurce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Bean"><span class="toc-text">(3) @Bean</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Value"><span class="toc-text">(4) @Value</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【掌握】profiles配置详解【切换环境】"><span class="toc-text">【掌握】profiles配置详解【切换环境】</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-开发环境与生产环境"><span class="toc-text">(1) 开发环境与生产环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-application-profile-properties：作用在全局"><span class="toc-text">(2) application-{profile}.properties：作用在全局</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Profile：作用在类或方法上"><span class="toc-text">(3) @Profile：作用在类或方法上</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-yml文件的多配置块的集成切换"><span class="toc-text">(4) yml文件的多配置块的集成切换</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【掌握】配置文件的优先级-和-外部配置文件加载"><span class="toc-text">【掌握】配置文件的优先级 和 外部配置文件加载</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-项目内部配置文件的优先级"><span class="toc-text">(1) 项目内部配置文件的优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-外部配置文件"><span class="toc-text">(2) 外部配置文件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#————————-1"><span class="toc-text">————————-</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【重点】自动配置原理-Conditional"><span class="toc-text">【重点】自动配置原理 + @Conditional</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-自动配置原理"><span class="toc-text">(1) 自动配置原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Conditional"><span class="toc-text">(2) @Conditional</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#————————-2"><span class="toc-text">————————-</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【掌握】Web静态资源的访问规则【直接访问】"><span class="toc-text">【掌握】Web静态资源的访问规则【直接访问】</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-静态资源的访问优先级"><span class="toc-text">(1) 静态资源的访问优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-静态资源加载原理"><span class="toc-text">(2) 静态资源加载原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-自定义静态资源路径"><span class="toc-text">(3) 自定义静态资源路径</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-webjars的访问配置"><span class="toc-text">(4) webjars的访问配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【掌握】thymeleaf【间接访问-跳转】"><span class="toc-text">【掌握】thymeleaf【间接访问_跳转】</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-thymeleaf的文件存放位置-访问"><span class="toc-text">(1) thymeleaf的文件存放位置 + 访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-thymeleaf-包在-SpringBoot-的位置"><span class="toc-text">(1-1) thymeleaf 包在 SpringBoot 的位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-访问静态资源"><span class="toc-text">(1-2) 访问静态资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-原理"><span class="toc-text">(1-3) 原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-yml修改thymeleaf的文件位置"><span class="toc-text">(1-4) yml修改thymeleaf的文件位置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-thymeleaf的基本使用"><span class="toc-text">(2) thymeleaf的基本使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-引入命名空间"><span class="toc-text">(2-1) 引入命名空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-使用占位符获取数据"><span class="toc-text">(2-2) 使用占位符获取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-实例"><span class="toc-text">(2-3) 实例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【掌握】AOP开发"><span class="toc-text">【掌握】AOP开发</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【掌握】管理-扩展-SpringMVC组件"><span class="toc-text">【掌握】管理 + 扩展 SpringMVC组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-管理SpringMVC组件"><span class="toc-text">(1) 管理SpringMVC组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-使用springmvc时要配置的组件"><span class="toc-text">(1-1) 使用springmvc时要配置的组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-springboot自动管理springmvc的源码分析"><span class="toc-text">(1-2) springboot自动管理springmvc的源码分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-1-gt-前端控制器的自动管理"><span class="toc-text">&lt;1&gt;  前端控制器的自动管理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#找到WebMvcAutoConfiguration"><span class="toc-text">找到WebMvcAutoConfiguration</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#打开DispatcherServletAutoConfiguration"><span class="toc-text">打开DispatcherServletAutoConfiguration</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-2-gt-控制器的自动管理【自定义的-Controller】"><span class="toc-text">&lt;2&gt; 控制器的自动管理【自定义的 Controller】</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#自动扫描"><span class="toc-text">自动扫描</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#若不在启动类所在包及其子包下"><span class="toc-text">若不在启动类所在包及其子包下</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-3-gt-视图解析器的自动管理"><span class="toc-text">&lt;3&gt; 视图解析器的自动管理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#找到WebMvcAutoConfiguration-1"><span class="toc-text">找到WebMvcAutoConfiguration</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#进入-ContentNegotiatingViewResolver"><span class="toc-text">进入 ContentNegotiatingViewResolver</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#自定义前缀和后缀"><span class="toc-text">自定义前缀和后缀</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-4-gt-文件上传"><span class="toc-text">&lt;4&gt; 文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#打开-MultipartAutoConfiguration"><span class="toc-text">打开 MultipartAutoConfiguration</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#打开-MultipartProperties"><span class="toc-text">打开 MultipartProperties</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-5-gt-静态资源的访问"><span class="toc-text">&lt;5&gt; 静态资源的访问</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-6-gt-欢迎页面"><span class="toc-text">&lt;6&gt; 欢迎页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-7-gt-消息转化"><span class="toc-text">&lt;7&gt; 消息转化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lt-8-gt-格式化转化"><span class="toc-text">&lt;8&gt; 格式化转化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-扩展SpringMVC组件"><span class="toc-text">(2) 扩展SpringMVC组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-在容器中注册视图控制器【页面跳转】"><span class="toc-text">(2-1) 在容器中注册视图控制器【页面跳转】</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#通过控制器跳转"><span class="toc-text">通过控制器跳转</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#通过配置类跳转"><span class="toc-text">通过配置类跳转</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-日期格式化"><span class="toc-text">(2-2) 日期格式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-自定义格式化器"><span class="toc-text">(2-3) 自定义格式化器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-拦截器"><span class="toc-text">(2-4) 拦截器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【难点】内嵌web服务器的加载原理"><span class="toc-text">【难点】内嵌web服务器的加载原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-tomcat启动分析"><span class="toc-text">(1) tomcat启动分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-启动内嵌Jetty服务器"><span class="toc-text">(2) 启动内嵌Jetty服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修改pom-xml"><span class="toc-text">修改pom.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#启动"><span class="toc-text">启动</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#【掌握】Web三大组件的注册"><span class="toc-text">【掌握】Web三大组件的注册</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#回顾"><span class="toc-text">回顾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#servlet"><span class="toc-text">servlet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Filter"><span class="toc-text">Filter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Listener"><span class="toc-text">Listener</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注册"><span class="toc-text">注册</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#注册Servlet"><span class="toc-text">注册Servlet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注册Filter"><span class="toc-text">注册Filter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注册Listener"><span class="toc-text">注册Listener</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#监听器的分类"><span class="toc-text">监听器的分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#过程"><span class="toc-text">过程</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/post.png)"><div id="post-info"><div id="post-title"><div class="posttitle">SpringBoot 基础</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2019-12-19<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2019-12-22</time><div class="post-meta-wordcount"><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="【重要】SpringBoot的启动分析"><a href="#【重要】SpringBoot的启动分析" class="headerlink" title="【重要】SpringBoot的启动分析"></a>【重要】SpringBoot的启动分析</h1><p>进入<code>@SpringBootApplication</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span>	</span><br><span class="line"><span class="meta">@EnableAutoConfiguration</span></span><br><span class="line"><span class="meta">@ComponentScan</span>(</span><br><span class="line">    excludeFilters = &#123;<span class="meta">@Filter</span>(</span><br><span class="line">    type = FilterType.CUSTOM,</span><br><span class="line">    classes = &#123;TypeExcludeFilter.class&#125;</span><br><span class="line">), <span class="meta">@Filter</span>(</span><br><span class="line">    type = FilterType.CUSTOM,</span><br><span class="line">    classes = &#123;AutoConfigurationExcludeFilter.class&#125;</span><br><span class="line">)&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>（1）<code>@SpringBootConfiguration</code>：配置类，是对Spring的<code>@Controller</code>注解进行包装</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="meta">@Target</span>(&#123;ElementType.TYPE&#125;)</span><br><span class="line">&gt; <span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line">&gt; <span class="meta">@Documented</span></span><br><span class="line">&gt; <span class="meta">@Configuration</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<p>（2）<code>@EnableAutoConfiguration</code>：激活自动装配</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; @Target(&#123;ElementType.TYPE&#125;)	//作用在类上</span><br><span class="line">&gt; @Retention(RetentionPolicy.RUNTIME)	//运行时有效</span><br><span class="line">&gt; @Documented</span><br><span class="line">&gt; @Inherited</span><br><span class="line">&gt; @AutoConfigurationPackage	//自动扫描的包的配置</span><br><span class="line">&gt; @Import(&#123;AutoConfigurationImportSelector.class&#125;)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<ul>
<li><p><code>@AutoConfigurationPackage</code></p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;   &gt; <span class="meta">@Target</span>(&#123;ElementType.TYPE&#125;)</span><br><span class="line">&gt;   &gt; <span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line">&gt;   &gt; <span class="meta">@Documented</span></span><br><span class="line">&gt;   &gt; <span class="meta">@Inherited</span></span><br><span class="line">&gt;   &gt; <span class="comment">// 引入自动配置包的注册器（相当于：&lt;context:component:scan&gt; ）</span></span><br><span class="line">&gt;   &gt; <span class="meta">@Import</span>(&#123;Registrar.class&#125;</span><br><span class="line">&gt;   &gt;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li><p>进入<code>Registrar.class</code>：<strong>自动配置包就是启动了所在的包</strong>，把当前启动类所在的包注入到spring中，相当于扫描了当前启动类所在的包</p>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;     &gt; <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Registrar</span> <span class="keyword">implements</span> <span class="title">ImportBeanDefinitionRegistrar</span>, <span class="title">DeterminableImports</span> </span>&#123;</span><br><span class="line">&gt;     &gt;         Registrar() &#123;</span><br><span class="line">&gt;     &gt;         &#125;</span><br><span class="line">&gt;     &gt; </span><br><span class="line">&gt;     &gt;         <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerBeanDefinitions</span><span class="params">(AnnotationMetadata metadata, BeanDefinitionRegistry registry)</span> </span>&#123;</span><br><span class="line">&gt;     &gt;             AutoConfigurationPackages.register(registry, (<span class="keyword">new</span> AutoConfigurationPackages.PackageImport(metadata)).getPackageName());</span><br><span class="line">&gt;     &gt;         &#125;</span><br><span class="line">&gt;     &gt; </span><br><span class="line">&gt;     &gt;         <span class="function"><span class="keyword">public</span> Set&lt;Object&gt; <span class="title">determineImports</span><span class="params">(AnnotationMetadata metadata)</span> </span>&#123;</span><br><span class="line">&gt;     &gt;             <span class="keyword">return</span> Collections.singleton(<span class="keyword">new</span> AutoConfigurationPackages.PackageImport(metadata));</span><br><span class="line">&gt;     &gt;         &#125;</span><br><span class="line">&gt;     &gt;     &#125;</span><br><span class="line">&gt;     &gt;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
</blockquote>
<blockquote>
<pre><code>&gt;
&gt; </code></pre><ul>
<li>@Import({AutoConfigurationImportSelector.class})</li>
</ul>
<blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt;   &gt; <span class="keyword">protected</span> AutoConfigurationImportSelector.<span class="function">AutoConfigurationEntry <span class="title">getAutoConfigurationEntry</span><span class="params">(AutoConfigurationMetadata autoConfigurationMetadata, AnnotationMetadata annotationMetadata)</span> </span>&#123;</span><br><span class="line">&gt;   &gt;         <span class="keyword">if</span> (!<span class="keyword">this</span>.isEnabled(annotationMetadata)) &#123;</span><br><span class="line">&gt;   &gt;             <span class="keyword">return</span> EMPTY_ENTRY;</span><br><span class="line">&gt;   &gt;         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">&gt;   &gt;             AnnotationAttributes attributes = <span class="keyword">this</span>.getAttributes(annotationMetadata);</span><br><span class="line">&gt;   &gt;             </span><br><span class="line">&gt;   &gt;             <span class="comment">// 读取springboot提供的124个配置类，存放在`List&lt;String&gt; configurations` 中</span></span><br><span class="line">&gt;   &gt;             List&lt;String&gt; configurations = <span class="keyword">this</span>.getCandidateConfigurations(annotationMetadata, attributes);</span><br><span class="line">&gt;   &gt;             configurations = <span class="keyword">this</span>.removeDuplicates(configurations);</span><br><span class="line">&gt;   &gt;             Set&lt;String&gt; exclusions = <span class="keyword">this</span>.getExclusions(annotationMetadata, attributes);</span><br><span class="line">&gt;   &gt;             </span><br><span class="line">&gt;   &gt;             <span class="comment">// 根据项目中pom.xml引入的依赖（启动器starter）检查没有用到的配置类</span></span><br><span class="line">&gt;   &gt;             <span class="keyword">this</span>.checkExcludedClasses(configurations, exclusions);</span><br><span class="line">&gt;   &gt;             </span><br><span class="line">&gt;   &gt;             <span class="comment">// 将没有用到的配置类从`configurations`中移除</span></span><br><span class="line">&gt;   &gt;             configurations.removeAll(exclusions);</span><br><span class="line">&gt;   &gt;             configurations = <span class="keyword">this</span>.filter(configurations, autoConfigurationMetadata);</span><br><span class="line">&gt;   &gt;             <span class="keyword">this</span>.fireAutoConfigurationImportEvents(configurations, exclusions);</span><br><span class="line">&gt;   &gt;             <span class="keyword">return</span> <span class="keyword">new</span> AutoConfigurationImportSelector.AutoConfigurationEntry(configurations, exclusions);</span><br><span class="line">&gt;   &gt;         &#125;</span><br><span class="line">&gt;   &gt;     &#125;</span><br><span class="line">&gt;   &gt;</span><br></pre></td></tr></table></figure>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191219151102.png" class="lozad">



<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191219151419.png" class="lozad">







<img style="zoom:67%;" data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191219151442.png" class="lozad">

<blockquote>
<p>疑问：这124个自动配置类从哪里来？</p>
<p>读取了spring.factories配置文件</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191219151735.png" class="lozad"></p>
<p>将该文件中的这些配置类名放在<code>List&lt;String&gt;  configurations</code>中</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191219151812.png" class="lozad"></p>
</blockquote>
</blockquote>
</blockquote>
<p>（3）@ComponentScan：自动扫描</p>
<h1 id="【了解】SpringBoot热部署-Lombok"><a href="#【了解】SpringBoot热部署-Lombok" class="headerlink" title="【了解】SpringBoot热部署 + Lombok"></a>【了解】SpringBoot热部署 + Lombok</h1><p>在创建项目时</p>
<p>选中热部署启动器，可以不用重复启动项目就可以直接看到结果</p>
<p>选中Lombok启动器，可以不用在实体类中写getter和setter，直接在类名上加上<code>@Data</code>注解即可。</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191219152503.png" class="lozad"></p>
<h1 id="————————"><a href="#————————" class="headerlink" title="————————-"></a>————————-</h1><h1 id="【掌握】SpringBoot的2种配置文件语法"><a href="#【掌握】SpringBoot的2种配置文件语法" class="headerlink" title="【掌握】SpringBoot的2种配置文件语法"></a>【掌握】SpringBoot的2种配置文件语法</h1><p>环境：</p>
<blockquote>
<p>启动器（4个）</p>
<p>web、Lombok、dev-tool</p>
<p>configuration-processor：加入properties和yml文件的属性提示依赖，即编写属性值时有提示，提示包</p>
</blockquote>
<h2 id="1-properties-yml"><a href="#1-properties-yml" class="headerlink" title="(1) properties + yml"></a>(1) properties + yml</h2><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191219160243.png" class="lozad"></p>
<p>同一目录下，properties的优先级高于yml文件</p>
<blockquote>
<p>当properties配置了就不会去yml取值，没配才会去yml中取值</p>
<p>2中方式都是互补的（比如：properties中没有配置student.id，但是yml中配置了，此时会去yml中获取该数据）</p>
</blockquote>
<h2 id="2-配置文件占位符"><a href="#2-配置文件占位符" class="headerlink" title="(2) 配置文件占位符"></a>(2) 配置文件占位符</h2><p>随机数</p>
<blockquote>
<p>${random.int}：生成一个int的随机数</p>
<p>${random.value}：生成一个随机数</p>
<p>${random.long}：生成一个long的随机数</p>
<p>${random.int(10)}：生成0~10的随机int数</p>
<p>${random.int[10,100]}生成10~100的随机int数</p>
</blockquote>
<p>IOC容器对象读取</p>
<blockquote>
<p>${student.name}：读取IOC容器中的student对象的name属性</p>
</blockquote>
<h1 id="【掌握】常用注解"><a href="#【掌握】常用注解" class="headerlink" title="【掌握】常用注解"></a>【掌握】常用注解</h1><h2 id="1-propertySource"><a href="#1-propertySource" class="headerlink" title="(1) @propertySource"></a>(1) @propertySource</h2><p>可以使用自定义名称的配置文件</p>
<p>上面的注入都是以默认名的properties文件注入的，</p>
<p>自己创建配置文件时，需要加上propertySource  注解才能生效，否则无法识别</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191219161604.png" class="lozad"></p>
<h2 id="2-ImportRouurce"><a href="#2-ImportRouurce" class="headerlink" title="(2) @ImportRouurce"></a>(2) @ImportRouurce</h2><p>springboot没有使用spring的xml配置文件，而是使用properties文件或者yml文件</p>
<p>如果自己创建了spring的xml配置文件，要使用该文件，只需要在启动类中<code>@ImportSource</code>该文件即可</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191219233041.png" class="lozad"></p>
<h2 id="3-Bean"><a href="#3-Bean" class="headerlink" title="(3) @Bean"></a>(3) @Bean</h2><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220011000.png" class="lozad"></p>
<h2 id="4-Value"><a href="#4-Value" class="headerlink" title="(4) @Value"></a>(4) @Value</h2><p>特点：主动向IOC容器中获取对象的值</p>
<p>而@ConfigurationProperties是对象被动的接收IOC容器注入的值</p>
<blockquote>
<p>使用@Value只能注入普通的属性【基本数据类型、String、Date、数组、List、Set】</p>
<p>无法注入复杂的属性【获取到Map 和 自定义对象】</p>
<p>如果属性是使用驼峰命名法，则不能使用属性名注入</p>
<ul>
<li>@Value(“$(student.user-name)”)可以注入</li>
<li>@Value(“$(student.useName)”)无法注入</li>
</ul>
</blockquote>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220015715.png" class="lozad"></p>
<p><strong>@Value和COnfigurationProperties的比较</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>@ConfigurationProperties</th>
<th>@Value</th>
</tr>
</thead>
<tbody><tr>
<td>功能</td>
<td>批量注入配置文件中的属性</td>
<td>一个个指定</td>
</tr>
<tr>
<td>松散绑定（松散语法）</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>SpEL</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>JSR303数据校验</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>复杂类型封装</td>
<td>支持</td>
<td>不支持</td>
</tr>
</tbody></table>
<h1 id="【掌握】profiles配置详解【切换环境】"><a href="#【掌握】profiles配置详解【切换环境】" class="headerlink" title="【掌握】profiles配置详解【切换环境】"></a>【掌握】profiles配置详解【切换环境】</h1><h2 id="1-开发环境与生产环境"><a href="#1-开发环境与生产环境" class="headerlink" title="(1) 开发环境与生产环境"></a>(1) 开发环境与生产环境</h2><p>开发中，通常有2种环境：</p>
<ul>
<li>生产环境：项目上线，客户在使用中</li>
<li>开发环境：程序员在开发</li>
</ul>
<p>有时候开发环境和生产环境的配置方法是不一样的，</p>
<p>如何快速切换？需要用到profiles文件</p>
<h2 id="2-application-profile-properties：作用在全局"><a href="#2-application-profile-properties：作用在全局" class="headerlink" title="(2) application-{profile}.properties：作用在全局"></a>(2) application-{profile}.properties：作用在全局</h2><p>通过spring.profiles.active激活指定文件</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220110520.png" class="lozad"></p>
<h2 id="3-Profile：作用在类或方法上"><a href="#3-Profile：作用在类或方法上" class="headerlink" title="(3) @Profile：作用在类或方法上"></a>(3) @Profile：作用在类或方法上</h2><p>测试时会将<strong>当前激活的profile文件对应的Bean</strong>加入到<strong>IOC容器</strong>中</p>
<blockquote>
<p>以下例子激活的profile是pro，那么加入到IOC容器中的Bean就是getUser2</p>
<p>此时自动注入的user也就是 getUser2 了</p>
</blockquote>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220111533.png" class="lozad"></p>
<h2 id="4-yml文件的多配置块的集成切换"><a href="#4-yml文件的多配置块的集成切换" class="headerlink" title="(4) yml文件的多配置块的集成切换"></a>(4) yml文件的多配置块的集成切换</h2><p>我们也可以不配置profile文件，直接在yml文件中配置</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220131707.png" class="lozad"></p>
<blockquote>
<p>注意：<strong>同名profile的优先级高于yml多配置快的集成</strong></p>
<p>当yml和同名profile文件同时配置（该profile已被激活）时，优先执行properties激活的profile文件</p>
<p>因此使用yml的多配置快时，需要删除对应的profile文件。</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220131117.png" class="lozad"></p>
</blockquote>
<h1 id="【掌握】配置文件的优先级-和-外部配置文件加载"><a href="#【掌握】配置文件的优先级-和-外部配置文件加载" class="headerlink" title="【掌握】配置文件的优先级 和 外部配置文件加载"></a>【掌握】配置文件的优先级 和 外部配置文件加载</h1><h2 id="1-项目内部配置文件的优先级"><a href="#1-项目内部配置文件的优先级" class="headerlink" title="(1) 项目内部配置文件的优先级"></a>(1) 项目内部配置文件的优先级</h2><p>springboot默认扫描的配置文件路径：</p>
<blockquote>
<p>file:/config/ application.properties（当前项目路径config目录下）</p>
<p>file:/application.properties（当前项目路径下）</p>
<p>classpath:/config/application.properties（类路径config目录下）</p>
<p>classpath:/application.properties（类路径下）</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">覆盖：</span><br><span class="line">** 优先级从高到低，高优先级的内容会覆盖低优先级的内容</span><br><span class="line"></span><br><span class="line">互补：</span><br><span class="line">** spring boot会从这四个位置全部加载配置文件</span><br><span class="line">** 当高优先级配置文件属性与低优先级配置文件有【不冲突的属性】</span><br><span class="line">** 则会互补配置</span><br></pre></td></tr></table></figure>

<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220132722.png" class="lozad"></p>
<p>源码：</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220133537.png" class="lozad"></p>
<h2 id="2-外部配置文件"><a href="#2-外部配置文件" class="headerlink" title="(2) 外部配置文件"></a>(2) 外部配置文件</h2><h1 id="————————-1"><a href="#————————-1" class="headerlink" title="————————-"></a>————————-</h1><h1 id="【重点】自动配置原理-Conditional"><a href="#【重点】自动配置原理-Conditional" class="headerlink" title="【重点】自动配置原理 + @Conditional"></a>【重点】自动配置原理 + @Conditional</h1><h2 id="1-自动配置原理"><a href="#1-自动配置原理" class="headerlink" title="(1) 自动配置原理"></a>(1) 自动配置原理</h2><blockquote>
<p>springboot启动会加载大量的自动配置类</p>
<p>我们看需要的功能有没有spring boot默认写好的自动配置类</p>
<p>在来看这个自动配置类配置的组件（只要有我们需要的组件，就无需再配置）</p>
<p>给容器中自动配置类添加组件时，会从properties类中获取某些属性</p>
<p>我们就可以在配置文件中指定这些属性的值：</p>
<ul>
<li>xxxAutoConfiguration：自动配置类，向容器中添加组件</li>
<li>xxxProperties：封装配置文件中的默认配置，即修改配置</li>
</ul>
</blockquote>
<h2 id="2-Conditional"><a href="#2-Conditional" class="headerlink" title="(2) @Conditional"></a>(2) @Conditional</h2><p>条件</p>
<h1 id="————————-2"><a href="#————————-2" class="headerlink" title="————————-"></a>————————-</h1><h1 id="【掌握】Web静态资源的访问规则【直接访问】"><a href="#【掌握】Web静态资源的访问规则【直接访问】" class="headerlink" title="【掌握】Web静态资源的访问规则【直接访问】"></a>【掌握】Web静态资源的访问规则【直接访问】</h1><h2 id="1-静态资源的访问优先级"><a href="#1-静态资源的访问优先级" class="headerlink" title="(1) 静态资源的访问优先级"></a>(1) 静态资源的访问优先级</h2><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220140711.png" class="lozad"></p>
<h2 id="2-静态资源加载原理"><a href="#2-静态资源加载原理" class="headerlink" title="(2) 静态资源加载原理"></a>(2) 静态资源加载原理</h2><p>打开WebMvcAutoConfiguration类，找到AddRourceHandler方法，然后…找到ResourceProperties（过程太多）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResourceProperties</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] CLASSPATH_RESOURCE_LOCATIONS = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">        <span class="string">"classpath:/META-INF/resources/"</span>, <span class="string">"classpath:/resources/"</span>, <span class="string">"classpath:/static/"</span>, <span class="string">"classpath:/public/"</span>&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="3-自定义静态资源路径"><a href="#3-自定义静态资源路径" class="headerlink" title="(3) 自定义静态资源路径"></a>(3) 自定义静态资源路径</h2><p>springboot除了上述4种路径配置的静态资源外，其他路劲的静态资源无法生效</p>
<p>如何使其生效？</p>
<blockquote>
<p> 创建配置类，使用注册器来注册该静态资源文件。</p>
</blockquote>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220142015.png" class="lozad"></p>
<h2 id="4-webjars的访问配置"><a href="#4-webjars的访问配置" class="headerlink" title="(4) webjars的访问配置"></a>(4) webjars的访问配置</h2><p>网站： <a href="https://www.webjars.org/" target="_blank" rel="noopener">https://www.webjars.org/</a> </p>
<p>导入依赖：pom.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.webjars&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jquery&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.4.1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>资源导入</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220143705.png" class="lozad"></p>
<p>资源访问</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220143630.png" class="lozad"></p>
<p><strong>原理：</strong></p>
<p>与前面的静态资源一样，</p>
<p>当你的url包含<code>/webjars/**</code>时，会自动访问到<code>classpath:/META-INF/resources/webjars/</code>下的资源</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> </span>&#123;</span><br><span class="line">           <span class="keyword">if</span> (!<span class="keyword">this</span>.resourceProperties.isAddMappings()) &#123;</span><br><span class="line">               logger.debug(<span class="string">"Default resource handling disabled"</span>);</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               Duration cachePeriod = <span class="keyword">this</span>.resourceProperties.getCache().getPeriod();</span><br><span class="line">               CacheControl cacheControl = <span class="keyword">this</span>.resourceProperties.getCache().getCachecontrol().toHttpCacheControl();</span><br><span class="line">               <span class="keyword">if</span> (!registry.hasMappingForPattern(<span class="string">"/webjars/**"</span>)) &#123;</span><br><span class="line">                   <span class="keyword">this</span>.customizeResourceHandlerRegistration(registry.addResourceHandler(<span class="keyword">new</span> String[]&#123;<span class="string">"/webjars/**"</span>&#125;).addResourceLocations(<span class="keyword">new</span> String[]&#123;<span class="string">"classpath:/META-INF/resources/webjars/"</span>&#125;).setCachePeriod(<span class="keyword">this</span>.getSeconds(cachePeriod)).setCacheControl(cacheControl));</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">               String staticPathPattern = <span class="keyword">this</span>.mvcProperties.getStaticPathPattern();</span><br><span class="line">               <span class="keyword">if</span> (!registry.hasMappingForPattern(staticPathPattern)) &#123;</span><br><span class="line">                   <span class="keyword">this</span>.customizeResourceHandlerRegistration(registry.addResourceHandler(<span class="keyword">new</span> String[]&#123;staticPathPattern&#125;).addResourceLocations(WebMvcAutoConfiguration.getResourceLocations(<span class="keyword">this</span>.resourceProperties.getStaticLocations())).setCachePeriod(<span class="keyword">this</span>.getSeconds(cachePeriod)).setCacheControl(cacheControl));</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<h1 id="【掌握】thymeleaf【间接访问-跳转】"><a href="#【掌握】thymeleaf【间接访问-跳转】" class="headerlink" title="【掌握】thymeleaf【间接访问_跳转】"></a>【掌握】thymeleaf【间接访问_跳转】</h1><p>thymeleaf是一个模板引擎，可以完全替代JSP（SpringBoot不支持JSP）</p>
<h2 id="1-thymeleaf的文件存放位置-访问"><a href="#1-thymeleaf的文件存放位置-访问" class="headerlink" title="(1) thymeleaf的文件存放位置 + 访问"></a>(1) thymeleaf的文件存放位置 + 访问</h2><p>环境搭建</p>
<p>引入thymeleaf的依赖（启动器）</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220144507.png" class="lozad"></p>
<h3 id="1-1-thymeleaf-包在-SpringBoot-的位置"><a href="#1-1-thymeleaf-包在-SpringBoot-的位置" class="headerlink" title="(1-1) thymeleaf 包在 SpringBoot 的位置"></a>(1-1) thymeleaf 包在 SpringBoot 的位置</h3><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220144955.png" class="lozad"></p>
<h3 id="1-2-访问静态资源"><a href="#1-2-访问静态资源" class="headerlink" title="(1-2) 访问静态资源"></a>(1-2) 访问静态资源</h3><p>thymeleaf必须放在 templates 目录下，而如何访问到templates 下的静态资源</p>
<p>在之前，我们自己创建的静态资源文件夹mystatic，只需要注册就行</p>
<p>但是templates 不一样，templates 就像以前的WEB-INF一样，直接访问其中的文件是访问不到的，需要通过控制器来请求转发才能访问到</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220145934.png" class="lozad"></p>
<h3 id="1-3-原理"><a href="#1-3-原理" class="headerlink" title="(1-3) 原理"></a>(1-3) 原理</h3><p>打开ThymeleafAutoConfiguration类，打开ThymeleafProperties.class</p>
<blockquote>
<p>默认前缀  <code>classpath:/templates/</code></p>
<p>默认后缀  <code>.html</code></p>
</blockquote>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220150045.png" class="lozad"></p>
<h3 id="1-4-yml修改thymeleaf的文件位置"><a href="#1-4-yml修改thymeleaf的文件位置" class="headerlink" title="(1-4) yml修改thymeleaf的文件位置"></a>(1-4) yml修改thymeleaf的文件位置</h3><p>也可以通过配置文件修改thymeleaf的文件的前后缀</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220151529.png" class="lozad"></p>
<h2 id="2-thymeleaf的基本使用"><a href="#2-thymeleaf的基本使用" class="headerlink" title="(2) thymeleaf的基本使用"></a>(2) thymeleaf的基本使用</h2><h3 id="2-1-引入命名空间"><a href="#2-1-引入命名空间" class="headerlink" title="(2-1) 引入命名空间"></a>(2-1) 引入命名空间</h3><p>在静态页面引入命名空间：<code>xmlns:th=&quot;http://www.thymeleaf.org&quot;</code></p>
<h3 id="2-2-使用占位符获取数据"><a href="#2-2-使用占位符获取数据" class="headerlink" title="(2-2) 使用占位符获取数据"></a>(2-2) 使用占位符获取数据</h3><p>链接URL表达式：@{}   访问url</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; th:href=&quot;@&#123;/layui/css/layui.css&#125;&quot;</span><br><span class="line">&gt; &lt;img th:src=&quot;@&#123;/layui/images/a.jpg&#125;&quot;&gt;</span><br><span class="line">&gt; &lt;form th:action=&quot;@&#123;/user/getuser&#125;&quot;&gt;&lt;/form&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>变量表达式：${}   访问变量（比如model中的）</p>
<p>信息表达式：#{}   访问常量（比如在配置文件中的）</p>
<blockquote>
<p> 访问带参数的消息：#{page.welcome(‘1’,’2’)}</p>
</blockquote>
<h3 id="2-3-实例"><a href="#2-3-实例" class="headerlink" title="(2-3) 实例"></a>(2-3) 实例</h3><blockquote>
<p>读取配置文件中的常量</p>
<p>读取控制器中的model的数据（变量 + list）</p>
</blockquote>
<p>引入layui</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220163259.png" class="lozad"></p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220163756.png" class="lozad"></p>
<p>国际化配置（防止获取不到数据）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">I18NConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResourceBundleMessageSource <span class="title">messageSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ResourceBundleMessageSource messageSource = <span class="keyword">new</span> ResourceBundleMessageSource();</span><br><span class="line">        <span class="comment">// 是否加载消息</span></span><br><span class="line">        messageSource.setUseCodeAsDefaultMessage(<span class="keyword">true</span>);</span><br><span class="line">        messageSource.setFallbackToSystemLocale(<span class="keyword">false</span>);</span><br><span class="line">        <span class="comment">// 设置spring读取的配置文件的名字，前缀名为user的</span></span><br><span class="line">        messageSource.setBasename(<span class="string">"user"</span>);</span><br><span class="line">        messageSource.setDefaultEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        messageSource.setCacheSeconds(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> messageSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">myController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/show"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">show</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        model.addAttribute(<span class="string">"admin"</span>,<span class="string">"超级管理员"</span>);</span><br><span class="line">        model.addAttribute(<span class="string">"place"</span>,<span class="string">"人员管理系统"</span>);</span><br><span class="line"></span><br><span class="line">        student student = <span class="keyword">new</span> student(<span class="number">10002</span>, <span class="string">"老王"</span>, <span class="keyword">true</span>, <span class="keyword">new</span> Date());</span><br><span class="line">        model.addAttribute(<span class="string">"student"</span>,student);</span><br><span class="line"></span><br><span class="line">        ArrayList&lt;Object&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;<span class="number">4</span> ; i++) &#123;</span><br><span class="line">            list.add(<span class="keyword">new</span> student(<span class="number">1000</span>*(i+<span class="number">1</span>),<span class="string">"小明"</span>+i,<span class="keyword">true</span>,<span class="keyword">new</span> Date()));</span><br><span class="line">        &#125;</span><br><span class="line">        model.addAttribute(<span class="string">"list"</span>,list);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"show"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"//res.layui.com/layui/dist/css/layui.css"</span>  <span class="attr">th:href</span>=<span class="string">"@&#123;/layui/css/layui.css&#125;"</span> <span class="attr">media</span>=<span class="string">"all"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--获取常量，访问带参数的消息--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">th:text</span>=<span class="string">"#&#123;page.welcome('1','2')&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align: right"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;admin&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> |</span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;place&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--获取常量--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card-header"</span>&gt;</span>用户信息<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card-body"</span>&gt;</span></span><br><span class="line">            用户ID：<span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"#&#123;user.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card-body"</span>&gt;</span></span><br><span class="line">            用户姓名：<span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"#&#123;user.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--获取Model，变量--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card-header"</span>&gt;</span>学生信息<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card-body"</span>&gt;</span></span><br><span class="line">            学生ID：<span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;student.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card-body"</span>&gt;</span></span><br><span class="line">            学生姓名：<span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;student.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card-body"</span>&gt;</span></span><br><span class="line">            学生性别：<span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;student.sex?'男':'女'&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"layui-card-body"</span>&gt;</span></span><br><span class="line">            学生生日：<span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">"$&#123;#dates.format(student.date,'yyyy-MM-dd HH:mm:ss')&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--获取list--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"layui-table"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">colgroup</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">col</span> <span class="attr">width</span>=<span class="string">"150"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">col</span> <span class="attr">width</span>=<span class="string">"200"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">colgroup</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>昵称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>性别<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>生日<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">"stu:$&#123;list&#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;stu.id&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;stu.name&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;stu.sex?'男':'女'&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;#dates.format(stu.date,'yyyy-MM-dd HH:mm:ss')&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 获取数据</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> admin = <span class="string">'[[$&#123;admin&#125;]]'</span>;</span></span><br><span class="line">        alert(admin);</span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> place = [[$&#123;place&#125;]];</span></span><br><span class="line">        alert(place);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220164643.png" class="lozad"></p>
<h1 id="【掌握】AOP开发"><a href="#【掌握】AOP开发" class="headerlink" title="【掌握】AOP开发"></a>【掌握】AOP开发</h1><p><strong>环境</strong></p>
<p>加入AOP依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220170859.png" class="lozad"></p>
<h1 id="【掌握】管理-扩展-SpringMVC组件"><a href="#【掌握】管理-扩展-SpringMVC组件" class="headerlink" title="【掌握】管理 + 扩展 SpringMVC组件"></a>【掌握】管理 + 扩展 SpringMVC组件</h1><h2 id="1-管理SpringMVC组件"><a href="#1-管理SpringMVC组件" class="headerlink" title="(1) 管理SpringMVC组件"></a>(1) 管理SpringMVC组件</h2><h3 id="1-1-使用springmvc时要配置的组件"><a href="#1-1-使用springmvc时要配置的组件" class="headerlink" title="(1-1) 使用springmvc时要配置的组件"></a>(1-1) 使用springmvc时要配置的组件</h3><ol>
<li><strong>前端控制器</strong></li>
<li><strong>控制器映射器 + 适配器</strong><ol>
<li>映射器 Map&lt;Set<string>,Object&gt;<ol>
<li>Set<string> 存放资源地址  ： @RequestMapping (value={“hello1”,”hello2”})</string></li>
<li>Object 存放方法对象和方法所在的对象的对象<ol>
<li>执行方法 method.invoke(obj,args)</li>
</ol>
</li>
</ol>
</string></li>
<li>适配器<ol>
<li>@Controller</li>
<li>实现Controller接口</li>
<li>实现 HttpRequestHandler 接口</li>
</ol>
</li>
</ol>
</li>
<li><strong>视图解析器</strong><ol>
<li>InternalResourceViewResolver</li>
</ol>
</li>
<li><strong>文件上传</strong></li>
<li><strong>拦截器</strong></li>
</ol>
<h3 id="1-2-springboot自动管理springmvc的源码分析"><a href="#1-2-springboot自动管理springmvc的源码分析" class="headerlink" title="(1-2) springboot自动管理springmvc的源码分析"></a>(1-2) springboot自动管理springmvc的源码分析</h3><h4 id="lt-1-gt-前端控制器的自动管理"><a href="#lt-1-gt-前端控制器的自动管理" class="headerlink" title="&lt;1&gt;  前端控制器的自动管理"></a>&lt;1&gt;  前端控制器的自动管理</h4><h5 id="找到WebMvcAutoConfiguration"><a href="#找到WebMvcAutoConfiguration" class="headerlink" title="找到WebMvcAutoConfiguration"></a>找到WebMvcAutoConfiguration</h5><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220172824.png" class="lozad"></p>
<h5 id="打开DispatcherServletAutoConfiguration"><a href="#打开DispatcherServletAutoConfiguration" class="headerlink" title="打开DispatcherServletAutoConfiguration"></a>打开DispatcherServletAutoConfiguration</h5><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220173038.png" class="lozad"></p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220173107.png" class="lozad"></p>
<h4 id="lt-2-gt-控制器的自动管理【自定义的-Controller】"><a href="#lt-2-gt-控制器的自动管理【自定义的-Controller】" class="headerlink" title="&lt;2&gt; 控制器的自动管理【自定义的 Controller】"></a>&lt;2&gt; 控制器的自动管理【自定义的 Controller】</h4><h5 id="自动扫描"><a href="#自动扫描" class="headerlink" title="自动扫描"></a><strong>自动扫描</strong></h5><p>​    |– 默认扫描路径：启动类所在的包及其自子包</p>
<h5 id="若不在启动类所在包及其子包下"><a href="#若不在启动类所在包及其子包下" class="headerlink" title="若不在启动类所在包及其子包下"></a><strong>若不在启动类所在包及其子包下</strong></h5><p>​    |– 自定义扫描路径：使用@ComponentScan(basePackage={“com.yang.controller”})可以自定义添加扫描路径</p>
<h4 id="lt-3-gt-视图解析器的自动管理"><a href="#lt-3-gt-视图解析器的自动管理" class="headerlink" title="&lt;3&gt; 视图解析器的自动管理"></a>&lt;3&gt; 视图解析器的自动管理</h4><h5 id="找到WebMvcAutoConfiguration-1"><a href="#找到WebMvcAutoConfiguration-1" class="headerlink" title="找到WebMvcAutoConfiguration"></a>找到WebMvcAutoConfiguration</h5><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220173648.png" class="lozad"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 配置 InternalResourceViewResolver 视图解析器</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line">      <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> InternalResourceViewResolver <span class="title">defaultViewResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          InternalResourceViewResolver resolver = <span class="keyword">new</span> InternalResourceViewResolver();</span><br><span class="line">          resolver.setPrefix(<span class="keyword">this</span>.mvcProperties.getView().getPrefix());</span><br><span class="line">          resolver.setSuffix(<span class="keyword">this</span>.mvcProperties.getView().getSuffix());</span><br><span class="line">          <span class="keyword">return</span> resolver;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="comment">// 配置 BeanNameViewResolver 视图解析器</span></span><br><span class="line">      <span class="meta">@Bean</span></span><br><span class="line">      <span class="meta">@ConditionalOnBean</span>(&#123;View.class&#125;)</span><br><span class="line">      <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> BeanNameViewResolver <span class="title">beanNameViewResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          BeanNameViewResolver resolver = <span class="keyword">new</span> BeanNameViewResolver();</span><br><span class="line">          resolver.setOrder(<span class="number">2147483637</span>);</span><br><span class="line">          <span class="keyword">return</span> resolver;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 配置真正的试图解析器【作用：收集容器中拥有的试图解析器】</span></span><br><span class="line">      <span class="meta">@Bean</span></span><br><span class="line">      <span class="meta">@ConditionalOnBean</span>(&#123;ViewResolver.class&#125;)</span><br><span class="line">      <span class="meta">@ConditionalOnMissingBean</span>(</span><br><span class="line">          name = &#123;<span class="string">"viewResolver"</span>&#125;,</span><br><span class="line">          value = &#123;ContentNegotiatingViewResolver.class&#125;</span><br><span class="line">      )</span><br><span class="line">      <span class="function"><span class="keyword">public</span> ContentNegotiatingViewResolver <span class="title">viewResolver</span><span class="params">(BeanFactory beanFactory)</span> </span>&#123;</span><br><span class="line">          ContentNegotiatingViewResolver resolver = <span class="keyword">new</span> ContentNegotiatingViewResolver();</span><br><span class="line">          resolver.setContentNegotiationManager((ContentNegotiationManager)beanFactory.getBean(ContentNegotiationManager.class));</span><br><span class="line">          resolver.setOrder(-<span class="number">2147483648</span>);</span><br><span class="line">          <span class="keyword">return</span> resolver;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>

<h5 id="进入-ContentNegotiatingViewResolver"><a href="#进入-ContentNegotiatingViewResolver" class="headerlink" title="进入 ContentNegotiatingViewResolver"></a>进入 ContentNegotiatingViewResolver</h5><p>​    |– ContentNegotiatingViewResolver是一个<strong>视图解析器的收集器</strong></p>
<p>​    |– 默认有4个视图解析器</p>
<p>​    |– 只要IOC容器中实现了ViewResolver接口的对象，都会被收集起来，如之前配置的ThymeleafViewResolver</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221133917.png" class="lozad"></p>
<h5 id="自定义前缀和后缀"><a href="#自定义前缀和后缀" class="headerlink" title="自定义前缀和后缀"></a>自定义前缀和后缀</h5><p>默认的前缀和后缀均为空，因此为欧盟可以在主配值文件中，自定义前缀和后缀</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  thymeleaf:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span> <span class="comment"># 开启thymeleaf</span></span><br><span class="line"><span class="attr">    cache:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  mvc:</span>            </span><br><span class="line"><span class="attr">    view:</span>	<span class="comment"># 配置前缀后缀</span></span><br><span class="line"><span class="attr">      prefix:</span> <span class="string">/WEB-INF/views/</span></span><br><span class="line"><span class="attr">      suffix:</span> <span class="string">.html</span></span><br></pre></td></tr></table></figure>

<h4 id="lt-4-gt-文件上传"><a href="#lt-4-gt-文件上传" class="headerlink" title="&lt;4&gt; 文件上传"></a>&lt;4&gt; 文件上传</h4><h5 id="打开-MultipartAutoConfiguration"><a href="#打开-MultipartAutoConfiguration" class="headerlink" title="打开 MultipartAutoConfiguration"></a>打开 MultipartAutoConfiguration</h5><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221135515.png" class="lozad"></p>
<h5 id="打开-MultipartProperties"><a href="#打开-MultipartProperties" class="headerlink" title="打开 MultipartProperties"></a>打开 MultipartProperties</h5><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221135655.png" class="lozad"></p>
<h4 id="lt-5-gt-静态资源的访问"><a href="#lt-5-gt-静态资源的访问" class="headerlink" title="&lt;5&gt; 静态资源的访问"></a>&lt;5&gt; 静态资源的访问</h4><p>见 【Web静态资源的访问规则】</p>
<h4 id="lt-6-gt-欢迎页面"><a href="#lt-6-gt-欢迎页面" class="headerlink" title="&lt;6&gt; 欢迎页面"></a>&lt;6&gt; 欢迎页面</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> WelcomePageHandlerMapping <span class="title">welcomePageHandlerMapping</span><span class="params">(ApplicationContext applicationContext, FormattingConversionService mvcConversionService, ResourceUrlProvider mvcResourceUrlProvider)</span> </span>&#123;</span><br><span class="line">            WelcomePageHandlerMapping welcomePageHandlerMapping = <span class="keyword">new</span> WelcomePageHandlerMapping(<span class="keyword">new</span> TemplateAvailabilityProviders(applicationContext), applicationContext, <span class="keyword">this</span>.getWelcomePage(), <span class="keyword">this</span>.mvcProperties.getStaticPathPattern());</span><br><span class="line">            welcomePageHandlerMapping.setInterceptors(<span class="keyword">this</span>.getInterceptors(mvcConversionService, mvcResourceUrlProvider));</span><br><span class="line">            <span class="keyword">return</span> welcomePageHandlerMapping;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> Optional&lt;Resource&gt; <span class="title">getWelcomePage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            String[] locations = WebMvcAutoConfiguration.getResourceLocations(<span class="keyword">this</span>.resourceProperties.getStaticLocations());</span><br><span class="line">            <span class="keyword">return</span> Arrays.stream(locations).map(<span class="keyword">this</span>::getIndexHtml).filter(<span class="keyword">this</span>::isReadable).findFirst();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> Resource <span class="title">getIndexHtml</span><span class="params">(String location)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.resourceLoader.getResource(location + <span class="string">"index.html"</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>默认访问静态资源下的 <strong>static文件的index.html</strong>页面</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220140711.png" class="lozad"></p>
<h4 id="lt-7-gt-消息转化"><a href="#lt-7-gt-消息转化" class="headerlink" title="&lt;7&gt; 消息转化"></a>&lt;7&gt; 消息转化</h4><p>接收页面参数并格式化</p>
<p>找到 <strong>WebMvcAutoConfiguration</strong> 中的 addFormatters ()</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221140411.png" class="lozad"></p>
<p>进入addBean</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221140349.png" class="lozad"></p>
<p>这些注册器能自动将页面表单提交过来的数据，进行自动转换和封装</p>
<h4 id="lt-8-gt-格式化转化"><a href="#lt-8-gt-格式化转化" class="headerlink" title="&lt;8&gt; 格式化转化"></a>&lt;8&gt; 格式化转化</h4><p>接收页面参数并按照某种格式格式化，如日期</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  thymeleaf:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span> <span class="comment"># 开启thymeleaf</span></span><br><span class="line"><span class="attr">    cache:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># 配置日期格式化，指从前台到后台的格式化</span></span><br><span class="line">  <span class="comment"># 一般不使用</span></span><br><span class="line"><span class="attr">  mvc:</span></span><br><span class="line"><span class="attr">    date-format:</span> <span class="string">yyy-MM-dd</span> <span class="attr">HH:mm:ss</span></span><br></pre></td></tr></table></figure>

<h2 id="2-扩展SpringMVC组件"><a href="#2-扩展SpringMVC组件" class="headerlink" title="(2) 扩展SpringMVC组件"></a>(2) 扩展SpringMVC组件</h2><p>环境搭建：</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221142945.png" class="lozad"></p>
<h3 id="2-1-在容器中注册视图控制器【页面跳转】"><a href="#2-1-在容器中注册视图控制器【页面跳转】" class="headerlink" title="(2-1) 在容器中注册视图控制器【页面跳转】"></a>(2-1) 在容器中注册视图控制器【页面跳转】</h3><p>当页面跳转时，按照之前的做法，应当是在Controller中创建一个空方法跳转，</p>
<p>现在我们可以创建一个MvcConfig类，实现WebMvcConfigurer，重写AddViewController方法来跳转。</p>
<h4 id="通过控制器跳转"><a href="#通过控制器跳转" class="headerlink" title="通过控制器跳转"></a>通过控制器跳转</h4><p>之前我们通过控制器来请求转发和重定向，写的都是空方法，很消耗内存</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191220145934.png" class="lozad"></p>
<h4 id="通过配置类跳转"><a href="#通过配置类跳转" class="headerlink" title="通过配置类跳转"></a>通过配置类跳转</h4><p>可以都定义在一个配置类中，进行请求转发和重定向</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221144835.png" class="lozad"></p>
<h3 id="2-2-日期格式化"><a href="#2-2-日期格式化" class="headerlink" title="(2-2) 日期格式化"></a>(2-2) 日期格式化</h3><p>yml中配置的事件格式是全局有效的，若类型中也配置了时间格式，则以类型本身为准</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221150917.png" class="lozad"></p>
<h3 id="2-3-自定义格式化器"><a href="#2-3-自定义格式化器" class="headerlink" title="(2-3) 自定义格式化器"></a>(2-3) 自定义格式化器</h3><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221151813.png" class="lozad"></p>
<p><strong>普通写法</strong></p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221152644.png" class="lozad"></p>
<p><strong>JackSon 写法（常用）</strong></p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221152815.png" class="lozad"></p>
<p><strong>fastJson 写法 （了解）</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/fastjson --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.62<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（未完）</p>
<h3 id="2-4-拦截器"><a href="#2-4-拦截器" class="headerlink" title="(2-4) 拦截器"></a>(2-4) 拦截器</h3><ol>
<li><strong>创建拦截器</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"preHandle..."</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"postHandle..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"afterCompletion..."</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>注册拦截器</strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">        MyInterceptor myInterceptor = <span class="keyword">new</span> MyInterceptor();</span><br><span class="line">        registry.addInterceptor(myInterceptor)  <span class="comment">// 注册拦截器&lt;bean&gt;</span></span><br><span class="line">                .addPathPatterns(<span class="string">"/**"</span>)         <span class="comment">// 拦截的路径，可配置多个</span></span><br><span class="line">                .excludePathPatterns(<span class="string">"/getUser1"</span>);  <span class="comment">// 放行的路径，可配置多个</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><strong>测试</strong></li>
</ol>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221154333.png" class="lozad"></p>
<h1 id="【难点】内嵌web服务器的加载原理"><a href="#【难点】内嵌web服务器的加载原理" class="headerlink" title="【难点】内嵌web服务器的加载原理"></a>【难点】内嵌web服务器的加载原理</h1><p>springboot内嵌了tomcat，那么springboot是如何管理内置的服务器的？</p>
<h2 id="1-tomcat启动分析"><a href="#1-tomcat启动分析" class="headerlink" title="(1) tomcat启动分析"></a>(1) tomcat启动分析</h2><p>进入 ServletWebServerFactoryAutoConfiguration</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221160127.png" class="lozad"></p>
<p>进入EmbeddedTomcat</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221155558.png" class="lozad"></p>
<p>进入 TomcatServletWebServerFactory ，找到 getWebServer</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221155731.png" class="lozad"></p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221155801.png" class="lozad"></p>
<p>进入 TomcatWebServer</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221155437.png" class="lozad"></p>
<h2 id="2-启动内嵌Jetty服务器"><a href="#2-启动内嵌Jetty服务器" class="headerlink" title="(2) 启动内嵌Jetty服务器"></a>(2) 启动内嵌Jetty服务器</h2><p>springboot中可将默认使用的内嵌服务器tomcat改为jetty</p>
<h3 id="修改pom-xml"><a href="#修改pom-xml" class="headerlink" title="修改pom.xml"></a>修改pom.xml</h3><p>在pom.xml中排除tomcat依赖，添加Jetty的启动器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191221160701.png" class="lozad"></p>
<h1 id="【掌握】Web三大组件的注册"><a href="#【掌握】Web三大组件的注册" class="headerlink" title="【掌握】Web三大组件的注册"></a>【掌握】Web三大组件的注册</h1><h2 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h2><h3 id="servlet"><a href="#servlet" class="headerlink" title="servlet"></a>servlet</h3><blockquote>
<p>@WebServlet()</p>
<p><servlet></servlet></p>
<p><servlet-mapping></servlet-mapping></p>
</blockquote>
<h3 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h3><blockquote>
<p>@WebFilter()</p>
<p><filter></filter></p>
<p><filter-mapping></filter-mapping></p>
</blockquote>
<h3 id="Listener"><a href="#Listener" class="headerlink" title="Listener"></a>Listener</h3><blockquote>
<p>@WebListener</p>
<listener>    

<p><listener-class>    </listener-class></p>
</listener>
</blockquote>
<h2 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h2><h3 id="注册Servlet"><a href="#注册Servlet" class="headerlink" title="注册Servlet"></a>注册Servlet</h3><p>创建Servlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        String message1 = config.getInitParameter(<span class="string">"m1"</span>);</span><br><span class="line">        String message2 = config.getInitParameter(<span class="string">"m2"</span>);</span><br><span class="line">        System.out.println(message1 + <span class="string">""</span> + message2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> </span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> </span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"hello UserServlet"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserWebConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建UserServlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"userServlet"</span>)</span><br><span class="line">    <span class="meta">@ConditionalOnClass</span>(value = &#123;UserServlet.class&#125;)    <span class="comment">//项目中要有UserServlet类</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserServlet <span class="title">userServlet</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> UserServlet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册UserServlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnBean</span>(value = &#123;UserServlet.class&#125;) <span class="comment">//IOC容器中要有UserServlet类型的bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean&lt;UserServlet&gt; <span class="title">servletServletRegistrationBeanUserServlet</span><span class="params">(UserServlet userServlet)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建注册器对象</span></span><br><span class="line">        ServletRegistrationBean&lt;UserServlet&gt; registrationBean = <span class="keyword">new</span> ServletRegistrationBean&lt;&gt;();</span><br><span class="line">        <span class="comment">// 注入Servlet</span></span><br><span class="line">        registrationBean.setServlet(userServlet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置参数</span></span><br><span class="line">        registrationBean.addInitParameter(<span class="string">"m1"</span>,<span class="string">"你好，我是m1"</span>);</span><br><span class="line">        registrationBean.addInitParameter(<span class="string">"m2"</span>,<span class="string">"你好，我是m2"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置映射</span></span><br><span class="line">        registrationBean.addUrlMappings(<span class="string">"/user1.action"</span>,<span class="string">"/user2.action"</span>);</span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191222150703.png" class="lozad"></p>
<h3 id="注册Filter"><a href="#注册Filter" class="headerlink" title="注册Filter"></a>注册Filter</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        String m1 = filterConfig.getInitParameter(<span class="string">"m1"</span>);</span><br><span class="line">        String m2 = filterConfig.getInitParameter(<span class="string">"m2"</span>);</span><br><span class="line">        System.out.println(m1 + <span class="string">"---"</span> + m2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doFilter..."</span>);</span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse); <span class="comment">//放行</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建AppFilter</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"appFilter"</span>)</span><br><span class="line">    <span class="meta">@ConditionalOnClass</span>(value = &#123;AppFilter.class&#125;)    <span class="comment">//项目中要有AppFilter类</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AppFilter <span class="title">AppFilter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AppFilter();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册UserServlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnBean</span>(value = &#123;AppFilter.class&#125;) <span class="comment">//IOC容器中要有UserServlet类型的bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterRegistrationBean&lt;AppFilter&gt; <span class="title">filterFilterRegistrationBeanAppFilter</span><span class="params">(AppFilter appFilter)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建注册器对象</span></span><br><span class="line">        FilterRegistrationBean&lt;AppFilter&gt; registrationBean = <span class="keyword">new</span> FilterRegistrationBean&lt;&gt;();</span><br><span class="line">        <span class="comment">// 注入filter</span></span><br><span class="line">        registrationBean.setFilter(appFilter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置参数</span></span><br><span class="line">        registrationBean.addInitParameter(<span class="string">"m1"</span>,<span class="string">"filter -- m1"</span>);</span><br><span class="line">        registrationBean.addInitParameter(<span class="string">"m2"</span>,<span class="string">"filter -- m2"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置映射</span></span><br><span class="line">        registrationBean.addServletNames(<span class="string">"userServlet"</span>);</span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191222151827.png" class="lozad"></p>
<h3 id="注册Listener"><a href="#注册Listener" class="headerlink" title="注册Listener"></a>注册Listener</h3><p>作用：监听三大作用域</p>
<h4 id="监听器的分类"><a href="#监听器的分类" class="headerlink" title="监听器的分类"></a>监听器的分类</h4><p><strong>ServletContext</strong></p>
<p>​    |– ServletContextListener    ServletContextAttributeListener</p>
<p><strong>HttpSession</strong></p>
<p>​    |– HttpSessionListener    HttpSessionAttributeListener</p>
<p><strong>ServletRequest</strong></p>
<p>​    |– ServletRequestListener    ServletRequestAttributeListener</p>
<h4 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h4><p>以ServletContextListener为例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        String m1 = filterConfig.getInitParameter(<span class="string">"m1"</span>);</span><br><span class="line">        String m2 = filterConfig.getInitParameter(<span class="string">"m2"</span>);</span><br><span class="line">        System.out.println(m1 + <span class="string">"---"</span> + m2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doFilter..."</span>);</span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse); <span class="comment">//放行</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span>  <span class="comment">//配置类</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"web"</span>)</span><br><span class="line"><span class="meta">@Data</span>   <span class="comment">//提供获取appListenerEnabled的get方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserWebConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Boolean appListenerEnable = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建UserServlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"userServlet"</span>)</span><br><span class="line">    <span class="meta">@ConditionalOnClass</span>(value = &#123;UserServlet.class&#125;)    <span class="comment">//项目中要有UserServlet类</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserServlet <span class="title">userServlet</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> UserServlet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册UserServlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnBean</span>(value = &#123;UserServlet.class&#125;) <span class="comment">//IOC容器中要有UserServlet类型的bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletRegistrationBean&lt;UserServlet&gt; <span class="title">servletServletRegistrationBeanUserServlet</span><span class="params">(UserServlet userServlet)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建注册器对象</span></span><br><span class="line">        ServletRegistrationBean&lt;UserServlet&gt; registrationBean = <span class="keyword">new</span> ServletRegistrationBean&lt;&gt;();</span><br><span class="line">        <span class="comment">// 注入Servlet</span></span><br><span class="line">        registrationBean.setServlet(userServlet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置参数</span></span><br><span class="line">        registrationBean.addInitParameter(<span class="string">"m1"</span>,<span class="string">"你好，我是m1"</span>);</span><br><span class="line">        registrationBean.addInitParameter(<span class="string">"m2"</span>,<span class="string">"你好，我是m2"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置映射</span></span><br><span class="line">        registrationBean.addUrlMappings(<span class="string">"/user1.action"</span>,<span class="string">"/user2.action"</span>);</span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建AppFilter</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"appFilter"</span>)</span><br><span class="line">    <span class="meta">@ConditionalOnClass</span>(value = &#123;AppFilter.class&#125;)    <span class="comment">//项目中要有AppFilter类</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AppFilter <span class="title">AppFilter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AppFilter();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册UserServlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnBean</span>(value = &#123;AppFilter.class&#125;) <span class="comment">//IOC容器中要有UserServlet类型的bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterRegistrationBean&lt;AppFilter&gt; <span class="title">filterFilterRegistrationBeanAppFilter</span><span class="params">(AppFilter appFilter)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建注册器对象</span></span><br><span class="line">        FilterRegistrationBean&lt;AppFilter&gt; registrationBean = <span class="keyword">new</span> FilterRegistrationBean&lt;&gt;();</span><br><span class="line">        <span class="comment">// 注入filter</span></span><br><span class="line">        registrationBean.setFilter(appFilter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置参数</span></span><br><span class="line">        registrationBean.addInitParameter(<span class="string">"m1"</span>,<span class="string">"filter -- m1"</span>);</span><br><span class="line">        registrationBean.addInitParameter(<span class="string">"m2"</span>,<span class="string">"filter -- m2"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置映射</span></span><br><span class="line">        registrationBean.addServletNames(<span class="string">"userServlet"</span>);</span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建AppListener</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"appListener"</span>)</span><br><span class="line">    <span class="meta">@ConditionalOnClass</span>(value = &#123;AppListener.class&#125;)    <span class="comment">//项目中要有AppListener类</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AppListener <span class="title">appFilter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AppListener();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册UserServlet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnBean</span>(value = &#123;AppListener.class&#125;) <span class="comment">//IOC容器中要有UserServlet类型的bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletListenerRegistrationBean&lt;AppListener&gt; <span class="title">servletListenerRegistrationBean</span> <span class="params">(AppListener appListener)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建注册器对象</span></span><br><span class="line">        ServletListenerRegistrationBean&lt;AppListener&gt; registrationBean = <span class="keyword">new</span> ServletListenerRegistrationBean&lt;&gt;();</span><br><span class="line">        <span class="comment">// 注入listener</span></span><br><span class="line">        registrationBean.setListener(appListener);</span><br><span class="line">        registrationBean.setEnabled(appListenerEnable);</span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191222153610.png" class="lozad"></p>
<p>数据源配置 及 自动管理</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191222154151.png" class="lozad"></p>
<p>配置url：</p>
<p>使用DriverManagerDataSource</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191222155550.png" class="lozad"></p>
<p>使用DBCP</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191222155944.png" class="lozad"></p>
<p>使用druid【使用官方提供的】</p>
<p>引入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid-spring-boot-starter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置数据源</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#数据源配置</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    druid:</span></span><br><span class="line"><span class="attr">      driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">      url:</span> <span class="attr">jbdc:mysql://127.0.0.1:3306/boot_demo</span></span><br><span class="line"><span class="attr">      username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">      password:</span> <span class="number">123456</span></span><br><span class="line"><span class="attr">      max-active:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">        min-idle:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">        max-wait:</span> <span class="number">5000</span></span><br><span class="line"><span class="attr">        initial-size:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">        validation-query:</span> <span class="string">select</span> <span class="string">l</span></span><br><span class="line"><span class="attr">      stat-view-servlet:</span></span><br><span class="line"><span class="attr">        enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">        login-username:</span> <span class="string">admin</span></span><br><span class="line"><span class="attr">        login-password:</span> <span class="string">admin</span></span><br><span class="line"><span class="attr">        allow:</span></span><br><span class="line"><span class="attr">        deny:</span></span><br><span class="line"><span class="attr">        url-pattern:</span> <span class="string">"/druid/*"</span></span><br></pre></td></tr></table></figure>

<p>排除默认数据源【启动类中】</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191222163647.png" class="lozad"></p>
<p>测试【运行启动类】</p>
<p>输入 <a href="http://localhost:8080/druid" target="_blank" rel="noopener">http://localhost:8080/druid</a></p>
<p>输入账号密码：admin  admin</p>
<p><img alt data-src="https://yanghanblog.oss-cn-hangzhou.aliyuncs.com/img/20191222163754.png" class="lozad"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">杨涵</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://cometorbityh.github.io/2019/12/19/SpringBoot-基础/">https://cometorbityh.github.io/2019/12/19/SpringBoot-基础/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://cometorbityh.github.io">MY</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button"><i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/2019/12/25/记录学习python遇到的一些问题-坑/"><img class="prev_cover lozad" data-src="undefined" onerror="onerror=null;src='/img/comment_bg.png'"><div class="label">上一篇</div><div class="prev_info"><span>记录学习python遇到的一些问题(坑)</span></div></a></div><div class="next-post pull-right"><a href="/2019/12/18/MYSQL高级篇/"><img class="next_cover lozad" data-src="undefined" onerror="onerror=null;src='/img/comment_bg.png'"><div class="label">下一篇</div><div class="next_info"><span>MYSQL高级篇</span></div></a></div></nav></div></div><footer><div id="footer"><div class="copyright">&copy;2018 - 2020 By 杨涵</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="nightshift fa fa-moon-o" id="nightshift" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/nightshift.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script>const observer = lozad(); // lazy loads elements with default selector as '.lozad'
observer.observe();
</script></body></html>